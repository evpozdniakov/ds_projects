<style>
    h1, h2, h3, h4, h5, h6 { color: darkorange;  font-weight: 700; }
    h1 { filter: hue-rotate(0deg); }
    h2 { filter: hue-rotate(10deg); }
    h3 { filter: hue-rotate(20deg); }
    h4 { filter: hue-rotate(30deg); }
    h5 { filter: hue-rotate(40deg); }

    strong {
        border: 1px solid #ccc;
        border-radius: 5px;
        padding-left: 0.2rem;
        padding-right: 0.2rem;
        filter: hue-rotate(40deg);
    }

    em {
        border-bottom: 2px dotted #ccc;
    }

    a, a:hover {
        text-decoration: underline;
    }

    @media (prefers-color-scheme: dark) {
        body { color: #ccc; }
        strong { border-color: #ccc; }
        em { border-color: #ccc; }
        img { background-color: rgba(255, 255, 255, 0.75) }
        a, a:hover { color: Violet; }
    }
    
    @media (prefers-color-scheme: light) {
        body { color: #333; }
        strong { border-color: #333; }
        em { border-color: #333; }
        /* img { background-color: rgba(0, 0, 0, 0.1) } */
        a, a:hover { color: DodgerBlue; }
    }
</style>

# Machine Learning

- Intro
    - –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è
        - –ò—Å–∫—É—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç (Artificial Intelligence)
            - –°–ª–∞–±—ã–π –ò–ò (Weak AI) 
            - –°–∏–ª—å–Ω—ã–π –ò–ò (Strong AI)
        - –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (Machine learning)
        - –ì–ª—É–±–æ–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ (Deep Learning)
    - –í–∏–¥—ã –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏
        - –û–±—É—á–µ–Ω–∏–µ —Å —É—á–∏—Ç–µ–ª–µ–º (supervised learning)
            - –†–µ–≥—Ä–µ—Å—Å–∏—è (regression)
            - –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ (forecasting)
            - –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
        - –û–±—É—á–µ–Ω–∏–µ –±–µ–∑ —É—á–∏—Ç–µ–ª—è (unsupervised learning)
            - –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è (clustering)
            - –ü–æ–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ (dimensionality reduction)
            - –ê—Å—Å–æ—Ü–∏–∞—Ü–∏—è (association)
        - –û–±—É—á–µ–Ω–∏–µ —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º (reinforcement learing)
    - –û–±–∑–æ—Ä –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ü–û
        - Waterfall
        - Agile
        - CRISP-DM
- Supervised learning / Regression üëà
    - –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è (Linear regression)
        - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞
            - 2D (–æ–¥–∏–Ω —Ñ–∞–∫—Ç–æ—Ä)
            - 3D (–¥–≤–∞ —Ñ–∞–∫—Ç–æ—Ä–∞)
            - nD (m —Ñ–∞–∫—Ç–æ—Ä–æ–≤)
        - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ª–∏–Ω–µ–π–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏
            - –§—É–Ω–∫—Ü–∏—è –æ—à–∏–±–∫–∏
            - MAE
            - MSE
    - –ú–µ—Ç—Ä–∏–∫–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
        - –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
            - Mean Absolute Error (MAE)
            - Mean Absolute Percent Error (MAPE)
            - Mean Squared Error (MSE)
            - Root Mean Squared Error (RMSE)
            - R¬≤ (coefficient of determination)
        - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –Ω–∞ python
    - –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
        - –ú–ù–ö –Ω–∞ python
        - –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è
    - Gradient descent
        - –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞
        - Stochastic Gradient Descent, SGD
            - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python
    - –°–º–µ—â–µ–Ω–∏–µ –∏ —Ä–∞–∑–±—Ä–æ—Å
    - Train & Test sets
        - –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python
    - –ü–æ–ª–∏–Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
        - –ü–æ–ª–∏–Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –≤—Ç–æ—Ä–æ–π —Å—Ç–µ–ø–µ–Ω–∏
        - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–ª–∏–Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ python
    - –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è
        - L1-—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (Lasso)
            - L1 –Ω–∞ python
        - L2-—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (Ridge)
            - L2 –Ω–∞ python
        - –ö–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏
        - –≠–ª–∞—Å—Ç–∏—á–Ω–∞—è —Å–µ—Ç–∫–∞
- Supervised learning / Classification
    - Logistic regression
        - –ó–∞–¥–∞—á–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
        - –†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ (intuition)
        - –°–∏–≥–º–æ–∏–¥–∞
        - –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è
        - –ü–æ–∏—Å–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
    - –ú–µ—Ç—Ä–∏–∫–∏ –∫–ª—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
    - –ú—É–ª—å—Ç–∏–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è

## Intro

### –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–Ω—è—Ç–∏—è

#### –ò—Å–∫—É—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç (Artificial Intelligence)

—ç—Ç–æ –∫–æ–º–ª–ø–µ–∫—Å–Ω–∞—è –Ω–∞—É–∫–∞ (–º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ + –ª–æ–≥–∏–∫–∞ + –±–∏–æ–ª–æ–≥–∏—è + –ø—Å–∏—Ö–æ–ª–æ–≥–∏—è + ...). –ï—ë —Ü–µ–ª—å ‚Äî¬†–Ω–∞—É—á–∏—Ç—å—Å—è –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –º–æ–∑–≥–∞.

(–ê –µ—â–µ –ò–ò –Ω–∞–∑—ã–≤–∞—é—Ç –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω—É—é —Å–∏—Å—Ç–µ–º—É, –ø–æ–∑–≤–æ–ª—è—é—â—É—é –∏–º–∏—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –º–æ–∑–≥–∞ —á–µ–ª–æ–≤–µ–∫–∞ –∏ —Ä–µ—à–∞—Ç—å –∫–∞–∫—É—é-–Ω–∏–±—É–¥—å –ø—Ä–∏–∫–ª–∞–¥–Ω—É—é –∑–∞–¥–∞—á—É.)

–†–∞–∑–¥–µ–ª—è—é—Ç c–∏–ª—å–Ω—ã–π –∏ —Å–ª–∞–±—ã–π –ò–ò.

##### –°–ª–∞–±—ã–π –ò–ò (Weak AI) 
—Å–ø–æ—Å–æ–±–µ–Ω —Ä–µ—à–∞—Ç—å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é –∑–∞–¥–∞—á—É –Ω–µ —Ö—É–∂–µ —á–µ–ª–æ–≤–µ–∫–∞, –∞ –∏–Ω–æ–≥–¥–∞ –¥–∞–∂–µ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥—è –µ–≥–æ.

##### –°–∏–ª—å–Ω—ã–π –ò–ò (Strong AI)
—Å–ø–æ—Å–æ–±–µ–Ω —Ä–µ—à–∞—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∑–∞–¥–∞—á, —É–º–µ–µ—Ç —É—á–∏—Ç—å—Å—è, –æ—Å–æ–∑–Ω–∞–µ—Ç —Å–µ–±—è ‚Äî¬†—ç—Ç–æ –ø–æ–∫–∞ —á—Ç–æ —Ç–æ–ª—å–∫–æ –º–µ—á—Ç–∞.

![](./images/ai-ml-dl.png)

#### –ú–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (Machine learning)

—ç—Ç–æ –Ω–∞–±–æ—Ä —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –ø—Ä–æ —Å–∞–º–æ–æ–±—É—á–∞—é—â–∏–µ—Å—è –∞–ª–≥–æ—Ä–∏—Ç–º—ã; –æ–Ω–æ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–¥—Ä–∞–∑–¥–µ–ª–æ–º –Ω–∞—É–∫–∏ –æ–± –ò–ò.

–¢–∞–∫–∂–µ —ç—Ç–æ –æ–¥–Ω–∞ –∏–∑ —Ç—Ä–µ—Ö —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏—Ö Data Science (–¥–≤–µ –¥—Ä—É–≥–∏–µ ‚Äî¬†*Data analytics* –∏ *Data engineering*)

–ê —Ç–∞–∫–∂–µ —ç—Ç–æ *–≥–ª–∞–≤–Ω–π –Ω–∞–≤—ã–∫ –¥–∞—Ç–∞-—Å–∞–π–µ–Ω—Ç–∏—Å—Ç–∞*, –ø–æ—Å–∫–æ–ª—å–∫—É –≤ –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–º —Å–º—ã—Å–ª–µ Data Science —ç—Ç–æ –ø—Ä–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –¥–ª—è –±–∏–∑–Ω–µ—Å –∑–∞–¥–∞—á.

ML –¥–µ—Ä–∂–∏—Ç—Å—è –Ω–∞ —Ç—Ä–µ—Ö —Å—Ç–æ–ª–ø–∞—Ö:
- –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö (dataset)
- –ø—Ä–∏–∑–Ω–∞–∫–∏ (features)
- –º–æ–¥–µ–ª—å (ML model)

![](./images/ml-three-pillars.png)

–ü—Ä–∏–∑–Ω–∞–∫–∏ –ø–æ –∫–æ—Ç–æ—Ä—ã–º –æ–±—É—á–∞–µ—Ç—Å—è –º–æ–¥–µ–ª—å, –∏–Ω–æ–≥–¥–∞ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è **—Ñ–∞–∫—Ç–æ—Ä–∞–º–∏** (factors).

–ü—Ä–∏–∑–Ω–∞–∫, –∫–æ—Ç–æ—Ä—ã–π –º–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å, –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **—Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫** (target feature). 

#### –ì–ª—É–±–æ–∫–æ–µ –æ–±—É—á–µ–Ω–∏–µ (Deep Learning)

–ø–æ–¥—Ä–∞–∑–¥–µ–ª –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è; –≤ –µ–≥–æ –æ—Å–Ω–æ–≤–µ –ª–µ–∂–∏—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã—Ö –Ω–µ–π—Ä–æ–Ω–Ω—ã—Ö —Å–µ—Ç–µ–π, –∏–º–∏—Ç–∏—Ä—É—é—â–∏—Ö —Ä–∞–±–æ—Ç—É –º–æ–∑–≥–∞.

### –í–∏–¥—ã –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏

–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ —Ä–∞–∑–¥–µ–ª—è–µ—Ç—Å—è –Ω–∞ —Ç—Ä–∏ –≤–∏–¥–∞

- –° —É—á–∏—Ç–µ–ª–µ–º (supervised learning)
- –ë–µ–∑ —É—á–∏—Ç–µ–ª—è (unsupervised learning)
- –° –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º (reinforcement learing)

#### –û–±—É—á–µ–Ω–∏–µ —Å —É—á–∏—Ç–µ–ª–µ–º (supervised learning)

–ø—Ä–∏–∑–≤–æ–¥–∏—Ç—Å—è –Ω–∞ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (—Å –∏–∑–≤–µ—Å—Ç–µ–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞). –¢–∞–∫–æ–π —Ç–∏–ø –æ–±—É—á–µ–Ω–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á—É *—Ä–µ–≥—Ä–µ—Å—Å–∏–∏*, *–ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è* –∏ *–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏*.

##### –†–µ–≥—Ä–µ—Å—Å–∏—è (regression)

—ç—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ (–Ω–µ–∫–æ–µ–≥–æ –≤–µ—â–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —á–∏—Å–ª–∞).

–†–µ–≥—Ä–µ—Å—Å–∏—è –±—ã–≤–∞–µ—Ç **–ª–∏–Ω–µ–π–Ω–∞—è (Linear)** –∏ **–ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω–∞—è (Polinomial)**. –ü–æ—Å–ª–µ–¥–Ω—è—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –±–æ–ª–µ–µ –≥–∏–±–∫–æ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞—Ç—å—Å—è –ø–æ–¥ –¥–∞–Ω–Ω—ã–µ, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –µ—Å—Ç—å —Ä–∏—Å–∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è.

![](./images/dst3-ml1-3_6.png)

##### –ü—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏–µ (forecasting)

–ú–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å, —á—Ç–æ —ç—Ç–æ —á–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ü–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–∞ –∏ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≤—Ä–µ–º–µ–Ω–∏, –ø—Ä–∏—á–µ–º –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.

![](./images/dst3-ml1-3_7.png)

##### –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è

—ç—Ç–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –æ–±—ä–µ–∫—Ç–∞ –∫ –æ–¥–Ω–æ–º—É –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö (–æ–±—ã—á–Ω–æ –¥–≤—É—Ö) –∫–ª–∞—Å—Å–æ–≤. –ï—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω—ã—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤—Å–µ–≥–æ –¥–≤–∞, —Ç–æ —ç—Ç–æ **–±–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è**, –µ—Å–ª–∏ –±–æ–ª–µ–µ —Ç–æ **–º–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è**

#### –û–±—É—á–µ–Ω–∏–µ –±–µ–∑ —É—á–∏—Ç–µ–ª—è (unsupervised learning)

–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –Ω–∞ –¥–∞–Ω–Ω—ã—Ö –±–µ–∑ —Ä–∞–∑–º–µ—Ç–∫–∏.

##### –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è (clustering)

–†–∞–∑–±–∏–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ —Ñ—É–Ω–∫—Ü–∏–∏ `p(x`<sub>i</sub>`, x`<sub>j</sub>`)` –Ω–∞–∏–º–µ–Ω—å—à–µ–≥–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è (—Ä–∞–∑–ª–∏—á–∏—è) –º–µ–∂–¥—É –Ω–∏–º–∏. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –º–æ–∂–Ω–æ –∑–∞–¥–∞—Ç—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –∏–ª–∏ –Ω–µ –∑–∞–¥–∞–≤–∞—Ç—å.

##### –ü–æ–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ (dimensionality reduction)

–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ –∏—Å—Ö–æ–¥–Ω—ã–º –¥–∞–Ω–Ω—ã–º —Å–æ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. –¶–µ–ª—å ‚Äî¬†–ø–æ–ª—É—á–∏—Ç—å –æ–±–æ–±—â–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –ª–∏—à–Ω–∏—Ö –¥–µ—Ç–∞–ª–µ–π.

–ú–µ—Ç–æ–¥ –ø–æ–∑–≤–æ–ª—è–µ—Ç:
- –∞–±—Å—Ç—Ä–∞–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è –æ—Ç –ª–∏—à–Ω–∏—Ö –¥–µ—Ç–∞–ª–µ–π;
- —É—Å–∫–æ—Ä–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –Ω–∞ —Ä–µ–¥—É—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö;
- –∏–∑–±–∞–≤–∏—Ç—å—Å—è –æ—Ç –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç–∏ (–ø–æ—Å–∫–æ–ª—å–∫—É –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç –Ω–∞–∏–±–æ–ª–µ–µ —Å—Ö–æ–∂–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏).

![](./images/dst3-ml1-4_8.png)

–° –ø–æ–º–æ—â—å—é –¥–∞–Ω–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ –±—ã–ª–∞ —Å–æ–∑–¥–∞–Ω–∞ –º–æ–¥–µ–ª—å –¥–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ç–µ–º–∞—Ç–∏–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤. –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—É—é —Å–∏—Å—Ç–µ–º—É.

##### –ê—Å—Å–æ—Ü–∏–∞—Ü–∏—è (association)

–ü–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω—ã –ø–æ–≤–µ–¥–µ–Ω–∏—è:
- –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –Ω–∞ –≤–µ–±-—Å–∞–π—Ç–µ,
- –ø–æ–∫—É–ø–∞—Ç–µ–ª–µ–π –≤ –º–∞–≥–∞–∑–∏–Ω–µ,
- –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤ –∞–∫—Ü–∏–π –Ω–∞ –±–∏—Ä–∂–µ, –∏ —Ç.–¥.

#### –û–±—É—á–µ–Ω–∏–µ —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º (reinforcement learing)

–ú–æ–¥–µ–ª–∏ –æ–±—É—á–µ–Ω–Ω—ã–µ —Ç–∞–∫–∏–º –º–µ—Ç–æ–¥–æ–º –ø–æ–∑–≤–æ–ª—è—é—Ç —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á–∏ "–≤—ã–∂–∏–≤–∞–Ω–∏—è" –Ω–µ–∫–æ—Ç–æ—Ä–æ–≥–æ —Å—É–±—ä–µ–∫—Ç–∞ –≤ –Ω–µ–∫–æ—Ç–æ—Ä–æ–º –º–∏—Ä–µ. –ú–∏—Ä —ç—Ç–æ—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π (–ø–µ—Ä—Å–æ–Ω–∞–∂ –≤ –∫–æ–º–ø—å—é—Ç–µ—Ä–Ω–æ–π –∏–≥—Ä–µ) –∏–ª–∏ —Ä–µ–∞–ª—å–Ω—ã–π (–∞–≤—Ç–æ–ø–∏–ª–æ—Ç –Ω–∞ –¥–æ—Ä–æ–≥–µ).

–°—É–±—ä–µ–∫—Ç –≤ —Ç–∞–∫–∏—Ö –∑–∞–¥–∞—á–∞—Ö –Ω–∞–∑—ã–≤–∞—é—Ç "–∞–≥–µ–Ω—Ç–æ–º" (**agent**), –∞ –º–∏—Ä ‚Äî "—Å—Ä–µ–¥–æ–π" (**environment**). –í–æ –≤—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è  –∞–≥–µ–Ω—Ç –º–æ–∂–µ—Ç –Ω–∞–±–ª—é–¥–∞—Ç—å –∑–∞ —Å—Ä–µ–¥–æ–π, —Å–æ–≤–µ—Ä—à–∞—Ç—å –¥–µ–π—Ç—Å–≤–∏—è –∏ –ø–æ–ª—É—á–∞—Ç—å –æ—Ç —Å—Ä–µ–¥—ã –æ–±—Ä–∞—Ç–Ω—É—é —Ä–µ–∞–∫—Ü–∏—é (–ø–æ–æ—â—Ä–µ–Ω–∏–µ –∏–ª–∏ –Ω–∞–∫–∞–∑–∞–Ω–∏–µ).

–ê–≥–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç —Å–æ–±—Ä–∞—Ç—å –≤—Å—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å—Ä–µ–¥–µ –∏ –ø—Ä–æ—Å—á–∏—Ç–∞—Ç—å –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã. –ó–∞–¥–∞—á–∞ –æ–±—É—á–µ–Ω–∏—è ‚Äî –Ω–∞–π—Ç–∏ –Ω–∞–∏–ª—É—á—à—É—é —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤—ã–∂–∏–≤–∞–Ω–∏—è.

–°—É—â–µ—Å—Ç–≤—É—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –¥–∞–Ω–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –∑–∞–¥–∞—á:
- Q-learning
- SARSA
- DQN (Depp Q-Network) 
- Genetic algorithms –∏ –¥—Ä.

–ì–µ–Ω–µ—Ç–∏—á–µ—Å–∫–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–ª—É—á–∞–π–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π, –≤—ã–±–æ—Ä–µ –ª—É—á—à–∏—Ö –∏–∑ –Ω–∏—Ö, —Å–∏–Ω—Ç–µ–∑–∏—Ä–æ–≤–∞–Ω–∏–∏ —É–ª—É—á—à–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π –Ω–∞ –∏—Ö –æ—Å–Ω–æ–≤–µ –∏ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–∏ —ç—Ç–æ–≥–æ —Ü–∏–∫–ª–∞. –û–Ω–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤—Å–µ —Ä–µ–∂–µ, –ø–æ—Å–∫–æ–ª—å–∫—É —Å–∏–ª—å–Ω–æ —É—Å—Ç—É–ø–∞—é—Ç –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º –Ω–∞ –æ—Å–Ω–æ–≤–µ Q-learning.

### –û–±–∑–æ—Ä –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ü–û

#### Waterfall

–ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –ø–æ—ç—Ç–∞–ø–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω–µ—á–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞. –ö–∞–∂–¥—ã–π —ç—Ç–∞–ø –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –æ–¥–∏–Ω —Ä–∞–∑, –ø–æ—Å–ª–µ —á–µ–≥–æ –∫–æ–º–∞–Ω–¥–∞ –ø—Ä–∏—Å—Ç—É–ø–∞–µ—Ç –∫ —Å–ª–µ–¥—É—é—â–µ–º—É —ç—Ç–∞–ø—É. –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –æ–¥–Ω–æ–º—É –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —ç—Ç–∞–ø–æ–≤ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç. –£ –∫–æ–º–∞–Ω–¥—ã –µ—Å—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —à–∞–Ω—Å –æ—Ç–¥–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Å–≤–æ–µ–π —Ä–∞–±–æ—Ç—ã –∑–∞–∫–∞–∑—á–∏–∫—É. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏ –∫ —ç—Ç–æ–º—É –º–æ–º–µ–Ω—Ç—É –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –Ω–∞–π–¥–µ–Ω—ã –∏ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã.

–î–∞–Ω–Ω—É—é –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—é –º–æ–∂–Ω–æ –ø—Ä–∏–º–µ–Ω—è—Ç—å —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ —É –∫–æ–º–∞–Ω–¥—ã –µ—Å—Ç—å –æ–ø—ã—Ç —Ä–µ—à–µ–Ω–∏—è –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á. –ò–º–µ–Ω–Ω–æ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –ø—Ä–æ–µ–∫—Ç –º–æ–∂–Ω–æ —Ä–∞–∑–±–∏—Ç—å –Ω–∞ —ç—Ç–∞–ø—ã, —Å–æ–∑–¥–∞—Ç—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —ç—Ç–∞–ø–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å –≤—Å–µ —ç—Ç–∞–ø–∞ –ø–æ—Å–ª–µ–¥–æ–≤–¥–∞—Ç–µ–ª—å–Ω–æ –±–µ–∑ –æ—Ç–∫–ø–ª–æ–Ω–µ–Ω–∏–π –æ—Ç –¢–ó.

![](./images/waterfall.png)

#### Agile

–î–∞–Ω–Ω–∞—è –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è –ø—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ—Ç –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π —Ü–∏–∫–ª –∏—Ç–µ—Ä–∞—Ü–∏–π –ø–æ —É–ª—É—á—à–µ–Ω–∏—é –ø—Ä–æ–¥—É–∫—Ç–∞, –µ–≥–æ —ç–≤–æ–ª—é—Ü–∏—é. –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–æ–µ–∫—Ç–æ–≤, –Ω–µ –∏–º–µ—é—â–∏—Ö —á–µ—Ç–∫–∏—Ö –æ—á–µ—Ä—Ç–∞–Ω–∏–π. –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ —ç—Ç–∞–ø—É –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Å–ª–µ –Ω–µ—É–¥–∞—á–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏–ª–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

![](./images/agile.png)

–ú–∏–Ω—É—Å—ã –¥–∞–Ω–Ω–æ–π –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ –≤—ã—Ç–µ–∫–∞—é—Ç –∏–∑ –µ–µ –æ—Å–Ω–æ–≤–Ω—ã—Ö –ø—Ä–∏–Ω—Ü–∏–ø–æ–≤.

1. –ö–∞–∂–¥—ã–π —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ—Å–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ –∫–æ–Ω–µ—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –ù–æ –µ—Å–ª–∏ –≤—Å–µ –æ—Ç–≤–µ—á–∞—é—Ç, –∑–Ω–∞—á–∏—Ç –Ω–∏–∫—Ç–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç, –∏ –∫—Ä–∞–π–Ω–µ–≥–æ –Ω–µ –Ω–∞–π—Ç–∏.
2. –ö–∞–∂–¥—ã–π —Ü–∏–∫–ª –∏–º–µ–µ—Ç –∂–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω–Ω—ã–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π –∏–Ω—Ç–µ—Ä–≤–∞–ª (–æ–±—ã—á–Ω–æ 2 –Ω–µ–¥–µ–ª–∏), –∏ –Ω—É–∂–Ω–æ –≤ –Ω–µ–≥–æ —É–ª–æ–∂–∏—Ç—å—Å—è. –ù–æ –≤ —ç—Ç–æ–π —Å–ø–µ—à–∫–µ –Ω–µ –≤—Å–µ–≥–¥–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –≤—Ä–µ–º—è –Ω–∞ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ.

#### CRISP-DM

–î–∞–Ω–Ω—É—é –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—é –ø—Ä–∏–¥—É–º–∞–ª–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –∑–∞–¥–∞—á —Å –¥–∞–Ω–Ω—ã–º–∏ (*Cross-Industry Standard Process for Data Mining*). –û–Ω–∞ –ø–æ—Ö–æ–∂–∞ –Ω–∞ Agile —Ç–µ–º, —á—Ç–æ –∏–º–µ–µ—Ç —Ü–∏–∫–ª –∏—Ç–µ—Ä–∞—Ü–∏–π. –û–Ω–∞ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç Agile —Ç–µ–º, —á—Ç–æ —É –Ω–µ–µ –¥—Ä—É–≥–∏–µ —ç—Ç–∞–ø—ã, –ª—É—á—à–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –¥–ª—è –∑–∞–¥–∞—á –ø–æ ML, –∏ –∏—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –Ω–µ –æ–ø—Ä–µ–¥–ª–µ–Ω–∞ —Å—Ç—Ä–æ–≥–æ (–≤–æ–∑–º–æ–∂–µ–Ω –≤–æ–∑–≤—Ä–∞—Ç –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —ç—Ç–∞–ø, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —ç—Ç–∞–ø–æ–≤, –∞ —Ç–∞–∫–∂–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —ç—Ç–∞–ø–æ–≤).

![](./images/crisp-dm.png)

## Supervised learning / Regression

–ó–∞–¥–∞—á–∞ ‚Äî –Ω–∞—É—á–∏—Ç—å –º–æ–¥–µ–ª—å –ø–æ —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏ **—Ñ–∞–∫—Ç–æ—Ä–æ–≤** –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å **—Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫**. (–ò —Ñ–∞–∫—Ç–æ—Ä—ã, –∏ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫ ‚Äî —ç—Ç–æ –æ–±—ã—á–Ω—ã–µ —á–∏—Å–ª–∞.)

–¢–æ –µ—Å—Ç—å –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ –Ω–∞–π—Ç–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –º–µ–∂–¥—É –≤—Ö–æ–¥–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ (–º–Ω–æ–≥–æ —á–∏—Å–µ–ª) –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º (–æ–¥–Ω–æ —á–∏—Å–ª–æ).

### –õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è (Linear regression)

–ï—Å–ª–∏, *—Å–æ–≥–ª–∞—Å–Ω–æ –Ω–∞—à–µ–π –≥–∏–ø–æ—Ç–µ–∑–µ*, –æ–ø–∏—Å–∞–Ω–Ω–∞—è –≤—ã—à–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –∏–º–µ–µ—Ç –ª–∏–Ω–µ–π–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä, —Ç–æ –¥–ª—è –æ–±—É—á–µ–Ω–∏–µ –º—ã –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏.

#### –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞

–î–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞ –º–æ–¥–µ–ª—å –≤–Ω—É—Ç—Ä–∏ —Å–µ–±—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–∞–∫—É—é —Ñ–æ—Ä–º—É–ª—É:

`≈∑ = w‚ÇÄ + w‚ÇÅx‚ÇÅ + ... + w‚Çòx‚Çò`

–ü—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –º–æ–¥–µ–ª–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø–æ–¥–±–æ—Ä–∫–∞ –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ `w` —Ç–∞–∫–∏–º –æ–±—Ä–∞–æ–º, —á—Ç–æ–±—ã –Ω–∞ –≤—ã—Ö–æ–¥–µ –ø–æ–ª—É—á–∏–ª–∞—Å—å —Ñ—É–Ω–∫—Ü–∏—è, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—é—â–∞—è —Ü–µ–ª–µ–≤–æ–π . –≠—Ç–∏ –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è **–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏**.

##### 2D (–æ–¥–∏–Ω —Ñ–∞–∫—Ç–æ—Ä)

–ï—Å–ª–∏ –≤—Ö–æ–¥–Ω–æ–π —Ñ–∞–∫—Ç–æ—Ä —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω, —Ç–æ —Ñ–æ—Ä–º—É–ª–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–∞–∫–æ–π –≤–∏–¥:

`≈∑ = w‚ÇÄ + w‚ÇÅx‚ÇÅ`

–¢–∞–∫–∞—è –∂–µ —Ñ–æ—Ä–º—É–ª–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è –ª–∏–Ω–µ–π–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ –ø–ª–æ—Å–∫–æ—Å—Ç–∏:

`y = ax + b`

–ö–æ–≥–¥–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ `w‚ÇÄ` –∏ `w‚ÇÅ` –∏–∑–≤–µ—Å—Ç–Ω—ã, –º–æ–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫ —Ç–∞–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –ö–∞–∫ –≤–∏–¥–Ω–æ –æ–Ω —è–≤–ª—è–µ—Ç—Å—è –ª–∏–Ω–∏–µ–π –Ω–∞ –ø–ª–æ—Å–∫–æ—Å—Ç–∏.

![](./images/dst3-ml2-2_3.png)

##### 3D (–¥–≤–∞ —Ñ–∞–∫—Ç–æ—Ä–∞)

–ï—Å–ª–∏ —Ñ–∞–∫—Ç–æ—Ä–æ–≤ –¥–≤–∞, —Ç–æ –≤ —Ñ–æ—Ä–º—É–ª—É –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –Ω–æ–≤–∞—è –ø–∞—Ä–∞ `wx`

`≈∑ = w‚ÇÄ + w‚ÇÅx‚ÇÅ + w‚ÇÇx‚ÇÇ`

–ü—Ä–∏ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏—è—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –≥—Ä–∞—Ñ–∏–∫ –∫–æ–Ω–µ—á–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –∫–∞–∫ –ø–ª–æ—Å–∫–æ—Å—Ç—å –≤ —Ç—Ä–µ—Ö–º–µ—Ä–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.

![](./images/dst3-ml2-2_5.png)

##### nD (m —Ñ–∞–∫—Ç–æ—Ä–æ–≤)

–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–∫—Ç–æ—Ä–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –ª—é–±—ã–º. –ï—Å–ª–∏ —Ñ–∞–∫—Ç–æ—Ä–æ–≤ M, —Ç–æ –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç –≤—ã—á–∏—Å–ª—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–ª—è –ª–∏–Ω–µ–π–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –≤ N-–º–µ—Ä–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ (N = M + 1)

–ö–æ–Ω–µ—á–Ω–æ–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ `≈∑ = w‚ÇÄ + w‚ÇÅx‚ÇÅ + ... + w‚Çòx‚Çò`\
–±—É–¥–µ—Ç –æ–ø–∏—Å—ã–≤–∞—Ç—å *–≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç—å* (hyperplane) –≤ N-–º–µ—Ä–Ω–æ–º –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ.

#### –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ª–∏–Ω–µ–π–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏

–í—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ `w` –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏. –í —Å–∞–º–æ–º –Ω–∞—á–∞–ª–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã, –∏–º –ø—Ä–∏—Å–≤–∞–∏–≤–∞—é—Ç—Å—è —Å–ª—É—á–∞–π–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –∏ –º–æ–¥–µ–ª—å –≤—ã—á–∏—Å–ª—è–µ—Ç —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫ –Ω–∞—É–≥–∞–¥.
 
–í –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–±—É—á–µ–Ω–∏—è (–∫–æ—Ç–æ—Ä–æ–µ –ø–æ —Å—É—Ç–∏ –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å) –Ω–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —É–ª—É—á—à–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –∏ –º–æ–¥–µ–ª—å –≤—ã—á–∏—Å–ª—è–µ—Ç —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫ –≤—Å–µ –ª—É—á—à–µ.

–ö–∞–∫ —ç—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?

–ù–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –º–µ–Ω—è—é—Ç—Å—è —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —á—Ç–æ–±—ã **—Ñ—É–Ω–∫—Ü–∏—è –æ—à–∏–±–∫–∏** –¥–∞–≤–∞–ª–∞ –Ω–∞–∏–º–µ–Ω—å—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

![](./images/dst3-ml1-2_1.png)

##### –§—É–Ω–∫—Ü–∏—è –æ—à–∏–±–∫–∏

–ß—Ç–æ –µ—Å—Ç—å –æ—à–∏–±–∫–∞? –≠—Ç–æ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –º–µ–∂–¥—É –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ–º –∏ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é. 

![](./images/dst3-ml2-2_7.png)

–ú—ã –º–æ–∂–µ–º –ø–æ—Å—á–∏—Ç–∞—Ç—å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–æ—á–∫–∏ –∏ –∑–∞—Ç–µ–º –ø—Ä–æ—Å—É–º–º–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è. –ò–ª–∏ –∂–µ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–µ–Ω–Ω—É—é —Å—É–º–º—É —Ä–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –∫–æ–ª-–≤–æ —Ç–æ—á–µ–∫ –∏ –ø–æ–ª—É—á–∏—Ç—å —Å—Ä–µ–¥–Ω–µ–µ.

–î–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∏–º–µ–µ—Ç –≤—Ç–æ—Ä–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ ‚Äî **—Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å**.

##### MAE

MAE ‚Äî —ç—Ç–æ **—Å—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –æ—à–∏–±–∫–∞** (mean absolute error).

![](./images/mae.png)

–ö –Ω–µ—Å—á–∞—Å—Ç—å—é –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –µ—â–µ –Ω–µ –Ω–∞—É—á–∏–ª–∏—Å—å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–æ–±–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ –Ω–µ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∏—Ä—É–µ–º—ã (–Ω–µ –∏–º–µ—é—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–Ω–æ–π).

##### MSE

MSE ‚Äî —ç—Ç–æ **—Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞** (mean square error).

![](./images/mse.png)

–ü–æ —Å—É—Ç–∏ –¥–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–µ–ª–∞–µ—Ç —Ç–æ –∂–µ —Å–∞–º–æ–µ, —á—Ç–æ MAE, –Ω–æ –æ–Ω–∞ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∏—Ä—É–µ–º–∞, –∞ –º–∞—Ç–µ–º–∞—Ç–∏–∫–∏ –∑–Ω–∞—é—Ç, –∫–∞–∫ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–æ–±–Ω—ã–µ —Ñ—É–Ω—Ü–∏–∏. 

### –ú–µ—Ç—Ä–∏–∫–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏

**–ú–µ—Ç—Ä–∏–∫–∞** ‚Äî —ç—Ç–æ –æ—Ü–µ–Ω–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ –º–æ–¥–µ–ª–∏, –≤—ã—Ä–∞–∂–µ–Ω–Ω–∞—è —á–∏—Å–ª–æ–º.

–°—É—â–µ—Å—Ç–≤—É–µ—Ç [–º–Ω–æ–≥–æ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –º–µ—Ç—Ä–∏–∫](https://scikit-learn.ru/3-3-metrics-and-scoring-quantifying-the-quality-of-predictions/#regression-metrics) –¥–ª—è –∑–∞–¥–∞—á —Ä–µ–≥—Ä–µ—Å—Å–∏–∏. –ú—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º —Å–∞–º—ã–µ –æ—Å–Ω–æ–≤–Ω—ã–µ:
- MAE
- MAPE
- MSE
- RMSE
- R¬≤

#### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏

##### Mean Absolute Error (MAE)

–≠—Ç–æ **—Å—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –æ—à–∏–±–∫–∞** ‚Äî —Å—É–º–º–∞ `|y - »≥|` –¥–µ–ª–µ–Ω–∞—è –Ω–∞ –∫–æ–ª-–≤–æ.

![](./images/mae-2.png)

–°—É—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ—Å—Ç–∞ –∏ –ø–æ–Ω—è—Ç–Ω–∞. –ú–∏–Ω—É—Å –µ–µ –≤ —Ç–æ–º, —á—Ç–æ –ø–æ–ª—É—á–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –º–∞–ª–æ –æ —á–µ–º –≥–æ–≤–æ—Ä–∏—Ç (–µ—Å–ª–∏ –≤—ã –Ω–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç –≤ –∫–æ—Ä–∫—Ä–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏).

##### Mean Absolute Percent Error (MAPE)

–≠—Ç–æ **—Å—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö**

![](./images/mape.png)

##### Mean Squared Error (MSE)

**–°—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞** –∏–º–µ–µ—Ç —Ç—É –∂–µ —Ñ–æ—Ä–º—É–ª—É —á—Ç–æ –∏ —Å—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –æ—à–∏–±–∫–∞, –Ω–æ –≤–º–µ—Å—Ç–æ –º–æ–¥—É–ª—è –±–µ—Ä–µ—Ç—Å—è –∫–≤–∞–¥—Ä–∞—Ç –æ—à–∏–±–∫–∏

![](./images/mse-2.png)

–°—É—Ç—å –µ–µ —è—Å–Ω–∞ –¥–∞—Ç–∞-—Å–∞–π–µ–Ω—Ç–∏—Å—Ç—É, –Ω–æ –Ω–µ —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç—É —Ç–∞–∫–∞—è –º–µ—Ç—Ä–∏–∫–∞ –Ω–µ –±—É–¥–µ—Ç –ø–æ–Ω—è—Ç–Ω–∞.

–ü–æ–ª—å–∑–∞ —ç—Ç–æ–π –º–µ—Ç—Ä–∏–∫–∏ –≤ —Ç–æ–º, —á—Ç–æ –ø—Ä–∏ –µ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏, –æ–Ω–∞ –±—É–¥–µ—Ç –æ–±–µ—Ä–µ–≥–∞–µ—Ç –æ—Ç –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö –æ—à–∏–±–æ–∫. –ù–æ –µ—Å–ª–∏ –≤ –¥–∞–Ω–Ω—ã—Ö –∏–º–µ—é—Ç—Å—è –≤—ã–±–æ—Ä–æ—Å—ã, —Ç–æ —Ç–∞–∫–∞—è –º–µ—Ç—Ä–∏–∫–∞ (—Ç–æ—á–Ω–µ–µ –º–æ–¥–µ–ª—å –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –Ω–∞ –Ω–µ–π) –±—É–¥–µ—Ç –Ω–µ–æ–±—ä–µ–∫—Ç–∏–≤–Ω–æ–π.

##### Root Mean Squared Error (RMSE)

**–ö–æ—Ä–µ–Ω—å —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—à–∏–±–∫–∏** –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –ø—Ä–∏–≤–µ–¥–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ –æ—à–∏–±–∫–∏ —Å —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å—é —Ü–µ–ª–µ–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞.

![](./images/rmse.png)

–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ —É —ç—Ç–æ–π –º–µ—Ç—Ä–∏–∫–∏ —Ç–∞–∫–∏–µ –∂–µ –∫–∞–∫ –∏ —É MSE. –ö –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞–º –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –µ–µ –ª—É—á—à–∞—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å.

##### R¬≤ (coefficient of determination)

–ò–ª–∏ **–∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏** –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —á–∏—Å–ª–æ –æ—Ç -‚àû –¥–æ 1. –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω—ã–º —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±–æ–ª—å—à–µ 0.5, —á–µ–º –±–ª–∏–∂–µ –∫ –µ–¥–∏–Ω–∏—Ü–µ, —Ç–µ–º –ª—É—á—à–µ. –ï—Å–ª–∏ –º–µ—Ç—Ä–∏–∫–∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è, —Ç–æ –º–æ–¥–µ–ª—å –Ω–∞—Å—Ç–æ–ª—å–∫–æ –ø–ª–æ—Ö–∞, —á—Ç–æ –ª—É—á—à–µ –±—ã–ª–æ –±—ã –ø—Ä–∏—Å–≤–æ–∏—Ç—å –≤—Å–≤–µ–º –æ—Ç–≤–µ—Ç–∞–º —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.

–í —Ñ–æ—Ä–º—É–ª–µ –º–µ—Ç—Ä–∏–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **MSE<sub>mean</sub>**

![](./images/mse-mean.png)

–≥–¥–µ »≥ ‚Äî —Å—Ä–µ–¥–Ω–∏–π –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç. –°–∞–º–∞ —Ñ–æ—Ä–º—É–ª–∞ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫:

![](./images/r-squared.png)


#### –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –Ω–∞ python

```python
from sklearn import metrics

# MAE
metrics.metrics.mean_absolute_error(y, y_pred)

# MAPE
metrics.mean_absolute_percentage_error(y, y_pred)

# MSE
metrics.mean_squared_error(y, y_pred)

# RMSE
metrics.mean_squared_error(y, y_pred) ** 0.5

# R¬≤
metrics.r2_score(y, y_pred)
```

### –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–µ —Ä–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏

–î–µ–ª–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é **–º–µ—Ç–æ–¥–∞ –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –∫–≤–∞–¥—Ä–∞—Ç–æ–≤, –ú–ù–ö** (Ordinary least squares, OLS). –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ—Å—á–∏—Ç–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–ø–æ —Å—É—Ç–∏ —Ä–µ—à–∏—Ç—å —Å–∏—Å—Ç–µ–º—É —É—Ä–∞–≤–Ω–µ–Ω–∏–π). –î–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –ø—Ä–∏–¥—É–º–∞–ª –ì–∞—É—Å—Å –≤ 1975 –≥–æ–¥—É.

–î–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∏—Å–ø–ª—å–∑—É–µ—Ç—Å—è —Ñ–æ—Ä–º—É–ª–∞

`w = Q¬∑X·µÄ¬∑y`, –≥–¥–µ\
`Q = (X·µÄ¬∑X)‚Åª¬π`

#### –ú–ù–ö –Ω–∞ python

–ú–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å –ø–æ–º–æ—â—å—é `Numpy`, –∞ –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≥–æ—Ç–æ–≤—ã–º –º–µ—Ç–æ–¥–æ–º `sklearn`

```python
from sklearn import linear_model

lr_model = linear_model.LinearRegression()

lr_model.fit(X, y)

print('w0: {}'.format(lr_model.intercept_))
print('w1: {}'.format(lr_model.coef_)) 
```

#### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ—à–µ–Ω–∏—è

1. –¢—Ä–µ–±—É–µ—Ç—Å—è –º–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å–æ–≤\
–û–Ω–∏ –Ω—É–∂–Ω—ã –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ–π –º–∞—Ç—Ä–∏—Ü—ã. (–î–ª—è –º–∞—Ç—Ä–∏—Ü—ã m√óm –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è m¬≥ –æ–ø–µ—Ä–∞—Ü–∏–π)
2. –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏\
*–û–±—É—á–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏* (–∏–ª–∏ *–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ*) –Ω—É–∂–Ω–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∏ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ü—Ä–∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–º —Ä–µ—à–µ–Ω–∏–∏ –ø—Ä–∏–¥–µ—Ç—Å—è –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –∏ –Ω–∞—á–∏–Ω–∞—Ç—å –∏–∑ –∑–∞–Ω–æ–≤–æ.
3. –†–µ–∑—É–ª—å—Ç–∞—Ç –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω\
–ù–µ –≤—Å–µ –º–∞—Ç—Ä–∏—Ü—ã –æ–±—Ä–∞—Ç–∏–º—ã. (–≠—Ç–æ —Å–≤—è–∑–∞–Ω–æ —Å –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω–æ—Å—Ç—å—é.)

### Gradient descent

–ò–ª–∏ **–≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Å–ø—É—Å–∫** ‚Äî –∞–ª–≥–æ—Ä–∏—Ç–º, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –≤ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å, –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–º—É —Ä–µ—à–µ–Ω–∏—é. –ü–æ–∑–≤–æ–ª—è–µ—Ç –≤—ã—á–∏—Å–ª—è—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º (–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ).

–ü–æ —Å—É—Ç–∏ –¥–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ —à–∞–≥ –∑–∞ —à–∞–≥–æ–º –º–µ–Ω—è–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–≥—Ä–µ—Å–∏–∏, –ø—Ä–∏–±–ª–∏–∂–∞—è –∏—Ö –∫ –∑–Ω–∞—á–µ–Ω–∏—è–º, –∫–æ—Ç–æ—Ä—ã–µ –º–∏–Ω–∏–º–∏–∑–∏—Ä—É—é—Ç —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å.

–í–æ—Ç —Ç–∞–∫ –≤—ã—á–∏—Å–ª—è—é—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ:

![](./images/L-grad-formula.png)

–ó–¥–µ—Å—å `‚àáL` —ç—Ç–æ –≥—Ä–∞–¥–∏–µ–Ω—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å, –∞ `≈ã` **—Ç–µ–º–ø –æ–±—É—á–µ–Ω–∏—è** (learning rate).

#### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞

–£ n-–º–µ—Ä–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–Ω–æ–≥–æ **–ª–æ–∫–∞–ª—å–Ω—ã—Ö –º–∏–Ω–∏–º—É–º–æ–≤** ‚Äî —Ç–æ—á–µ–∫, –≥–¥–µ —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –º–∏–Ω–∏–º–∞–ª—å–Ω–∞ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å —Å–æ—Å–µ–¥–Ω–∏–º–∏ –æ–±–ª–∞—Å—Ç—è–º–∏. –ò —Ç–æ–ª—å–∫–æ –≤ –æ–¥–Ω–æ–π –∏–∑ —ç—Ç–∏—Ö —Ç–æ—á–µ–∫ —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å –±—É–¥–µ—Ç –∏–º–µ—Ç—å –Ω–∞–∏–º–µ–Ω—å—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –¢–∞–∫–∞—è —Ç–æ—á–∫–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–≥–ª–æ–±–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º—É–º**.

![](./images/dst3-ml2-4_11.png)

–°—É—â–µ—Å—Ç–≤—É—é—Ç —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Å–ø—É—Å–∫–∞, –ø–æ–∑–≤–æ–ª—è—é—â–∏–µ –±–æ—Ä–æ—Ç—å—Å—è —Å –¥–∞–Ω–Ω–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π. –û–¥–Ω–∞ –∏–∑ –Ω–∏—Ö ‚Äî

#### Stochastic Gradient Descent, SGD

–ï–≥–æ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å –≤ —Ç–æ–º, —á—Ç–æ –¥–ª—è –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞ –±–µ—Ä—É—Ç—Å—è –Ω–µ –≤—Å–µ –∏–º–µ—é—â–∏–µ—Å—è –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –∞ –∫–∞–∫–∞—è-—Ç–æ —Å–ª—É—á–∞–π–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∞–ª–≥–æ—Ä–∏—Ç–º –¥–≤–∏–∂–µ—Ç—Å—è –Ω–µ –ø—Ä—è–º–æ –∫ –º–∏–Ω–∏–º—É–º—É, –∞ "–∑–∞–∫–æ—É–ª–∫–∞–º–∏". –ë–ª–∞–≥–æ–¥–∞—Ä—è —ç—Ç–æ–º—É —É –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –µ—Å—Ç—å —à–∞–Ω—Å "–ø—Ä–æ—Å–∫–æ—á–∏—Ç—å" –Ω–µ–±–æ–ª—å—à–æ–π –ª–æ–∫–∞–ª—å–Ω—ã–π –º–∏–Ω–∏–º—É–º –∏ –Ω–∞–π—Ç–∏ –≥–ª–æ–±–∞–ª—å–Ω—ã–π.

![](./images/dst3-ml2-4_12.png)

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from sklearn import linear_model

#–°–æ–∑–¥–∞—ë–º –æ–±—ä–µ–∫—Ç –∫–ª–∞—Å—Å–∞ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Å SGD
sgd_lr_lstat = linear_model.SGDRegressor(random_state=42)
#–û–±—É—á–∞–µ–º –º–æ–¥–µ–ª—å ‚Äî –∏—â–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ –º–µ—Ç–æ–¥—É SGD
sgd_lr_lstat.fit(X, y)
```

–£ –¥–∞–Ω–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ [–º–Ω–æ–∂–µ—Å—Ç–≤–æ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤](https://scikit-learn.org/stable/modules/generated/sklearn.linear_model.SGDRegressor.html), –Ω–∞–ø—Ä–∏–º–µ—Ä:
- `loss` ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å
- `max_iter` - –∫–æ–ª-–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π
- `learning_rate` - —Ç–µ–º–ø –æ–±—É—á–µ–Ω–∏—è
- `eta0` - –Ω–∞—á–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —Ç–µ–º–ø–∞ –æ–±—É—á–µ–Ω–∏—è, –∏ —Ç.–¥.

### –°–º–µ—â–µ–Ω–∏–µ –∏ —Ä–∞–∑–±—Ä–æ—Å

**–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ** ‚Äî¬†—ç—Ç–æ —Ä–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —á–∏—Å–ª–æ –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—Å–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≥–µ–Ω–µ—Ä–∞–ª—å–Ω–æ–π —Å–æ–≤–æ–∫—É–ø–Ω–æ—Å—Ç–∏.

**–°–º–µ—â–µ–Ω–∏–µ** (bias) ‚Äî —ç—Ç–æ –º–∞—Ç. –æ–∂–∏–¥–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è.

**–†–∞–∑–±—Ä–æ—Å** (variance) ‚Äî —ç—Ç–æ —Ä–∞–∑–±—Ä–æ—Å (–¥–∏—Å–ø–µ—Ä—Å–∏—è) –æ—Ç–≤–µ—Ç–æ–≤ –º–æ–¥–µ–ª–∏, –æ–±—É—á–µ–Ω–Ω–æ–π –Ω–∞ —Ä–∞–∑–Ω—ã—Ö —á–∞—Å—Ç—è—Ö –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞. (–î–µ–ª–∏–º –¥–∞—Ç–∞—Å–µ—Ç –Ω–∞ —á–∞—Å—Ç–∏ 40%-40%-20%; –æ–±—É—á–∞–µ–º –¥–≤–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –ø–µ—Ä–≤—ã—Ö –¥–≤—É—Ö —á–∞—Å—Ç—è—Ö; —Ç–µ—Å—Ç–∏—Ä—É–µ–º –º–æ–¥–µ–ª–∏ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–π —á–∞—Å—Ç–∏ –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞–µ–º –∏—Ö –æ—Ç–≤–µ—Ç—ã –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º ‚Äî –Ω–∞—Å—Ç–æ—è—â–∏–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞–º –Ω–µ –≤–∞–∂–Ω—ã.)

![](./images/dst3-ml2-5_1.png)

–ï—Å–ª–∏ –º–æ–¥–µ–ª—å *–Ω–µ–¥–æ–æ–±—É—á–µ–Ω–∞*, —Ç–æ —É –Ω–µ–µ –±—É–¥–µ—Ç –±–æ–ª—å—à–æ–µ —Å–º–µ—â–µ–Ω–∏–µ (hi bias). –ï—Å–ª–∏ –º–æ–¥–µ–ª—å *–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∞*, —Ç–æ —É –Ω–µ–µ –±—É–¥–µ—Ç –≤—ã—Å–æ–∫–∏–π —Ä–∞–∑–±—Ä—Å (hi variance).

**–î–∏–ª–µ–º–º–∞ —Å–º–µ—â–µ–Ω–∏—è-—Ä–∞–∑–±—Ä–æ—Å–∞** –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ –ø–æ–∏—Å–∫–µ —Ç–∞–∫–æ–π –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å–ª–æ–∂–Ω–æ–π, —á—Ç–æ–±—ã —É–ª–æ–≤–∏—Ç—å –∏ –æ–±–æ–±—â–∏—Ç—å –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ –ø–æ–¥—Å—Ç—Ä–æ–∏—Ç—å—Å—è –ø–æ–¥ –æ—Ç–≤–µ—Ç—ã –¥–∞—Ç–∞—Å–µ—Ç–∞.

### Train & Test sets

–ß—Ç–æ–±—ã —Ä–µ—à–∏—Ç—å –¥–∏–ª–µ–º–º—É —Å–º–µ—â–µ–Ω–∏—è-—Ä–∞–∑–±—Ä–æ—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–π –ø–æ–¥—Ö–æ–¥. –î–∞—Ç–∞—Å–µ—Ç —Ä–∞–∑–¥–µ–ª—è—é—Ç –Ω–∞ —á–∞—Å—Ç–∏ –≤ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–∏ `4 : 1` —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å, **—Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö** (`X_train`) –∏ **—Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö** (`X_test`).

–ú–æ–¥–µ–ª—å –æ–±—É—á–∞—é—Ç –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–º –Ω–∞–±–æ—Ä–µ –∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º.

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

–î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è [`train_test_split`](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.train_test_split.html) –∏–∑ `sklearn.model_selection`.

```python
from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42, stratify=y)
```

–ü–∞—Ä–∞–º–µ—Ç—Ä `stratify` –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞ –≤ –æ–±–æ–∏—Ö —Å–µ—Ç–∞—Ö. –¢–∞–∫–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **—Å—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º**.

### –ü–æ–ª–∏–Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏

–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –≤ –¥–∞–Ω–Ω—ã—Ö —Ä–µ–¥–∫–æ –±—ã–≤–∞–µ—Ç –ª–∏–Ω–µ–π–Ω–æ–π. –ù–∞ —Ä–∏—Å—É–Ω–∫–µ –Ω–∏–∂–µ –º—ã –≤–∏–¥–∏–º, —á—Ç–æ –ª–∏–Ω–∏—è —Ö—É–∂–µ –æ–±–æ–±—â–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å, —á–µ–º –ø–∞—Ä–∞–±–æ–ª–∞.

![](./images/dst3-ml2-5_7.png)

–ß—Ç–æ–±—ã —É—Å–ª–æ–∂–Ω–∏—Ç—å –º–æ–¥–µ–ª—å –≤ –Ω–µ–µ –¥–æ–±–∞–≤–ª—è—é—Ç –∏—Å–∫—É—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –Ω–∞—Å—Ç–æ—è—â–∏—Ö **–ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏**. –≠—Ç–æ –æ–¥–∏–Ω –∏–∑ —Å–∞–º—ã—Ö —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ *Feature Engineering*..

–î–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è —Ç–∞ –∂–µ –ª–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è, –ø—Ä–æ—Å—Ç–æ —Å –Ω–æ–≤—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏.

#### –ü–æ–ª–∏–Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –≤—Ç–æ—Ä–æ–π —Å—Ç–µ–ø–µ–Ω–∏

–ß—Ç–æ–±—ã —É—Å–ª–æ–∂–Ω–∏—Ç—å –º–æ–¥–µ–ª—å –¥–æ –≤—Ç–æ—Ä–æ–π —Å—Ç–µ–ø–µ–Ω–∏, –≤—Å–µ –∏—Å—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤–æ–∑–≤–æ–¥—è—Ç—Å—è –≤ –∫–≤–∞–¥—Ä–∞—Ç –∏ –ø–µ—Ä–µ–º–Ω–æ–∂–∞—é—Ç—Å—è –º–µ–∂–¥—É —Å–æ–±–æ–π.

![](./images/dst3-ml2-5_8.png)

#### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø–æ–ª–∏–Ω–æ–º–∏–Ω–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ python

–î–µ–ª–∞–µ—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –∫–ª–∞—Å—Å–∞ [PolynomialFeatures](https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PolynomialFeatures.html)

```python
# –°–æ–∑–¥–∞—ë–º –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
# `include_bias` –¥–æ–±–∞–≤–∏—Ç —Å—Ç–æ–ª–±–µ—Ü –∏–∑ –µ–¥–∏–Ω–∏—Ü, x‚Å∞, —á—Ç–æ –Ω–µ –Ω—É–∂–Ω–æ –¥–ª—è –ú–ù–ö
poly = preprocessing.PolynomialFeatures(degree=2, include_bias=False)
poly.fit(X_train)

#–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏
X_train_poly = poly.transform(X_train)
X_test_poly = poly.transform(X_test)
```

### –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è

–≠—Ç–æ –º–µ—Ç–æ–¥, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –¥–ª—è –∑–∞—â–∏—Ç—ã –º–æ–¥–µ–ª–∏ –æ—Ç –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è. –°—É—Ç—å –µ–µ –≤ —Ç–æ–º, —á—Ç–æ–±—ã –Ω–µ —Ä–∞–∑—Ä–µ—à–∞—Ç—å –∫—ç—Ñ–∏—Ü–∏–µ–Ω—Ç–∞–º `w` –±—ã—Ç—å —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏–º–∏. –í–µ–¥—å —á–µ–º –±–æ–ª—å—à–µ —ç—Ç–∏ –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç—ã, —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ –º–∞–ª–µ–π—à–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

–î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —ç—Ç–æ–π –∏–¥–µ–∏ –≤ —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å –≤–Ω–æ—Å—è—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–ª–∞–≥–∞–µ–º—ã–µ ‚Äî **—à—Ç—Ä–∞—Ñ—ã**. –ß–µ–º –±–æ–ª—å—à–µ –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç—ã `w`, —Ç–µ–º –±–æ–ª—å—à–µ —à—Ç—Ä–∞—Ñ—ã, —Ç–µ–º –±–æ–ª—å—à–µ (–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ —Ö—É–∂–µ) —Ä–µ–∑—É–ª—å—Ç–∞—Ç —Ñ—É–Ω–∫—Ü–∏–∏. –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —É–¥–∞—Å—Ç—Å—è –∏–∑–±–µ–∂–∞—Ç—å —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–∏—Ö –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤.

#### L1-—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (Lasso)

–î–∞–Ω–Ω–∞—è –†. –¥–æ–±–∞–ª—è–µ—Ç –≤ —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å —Å—É–º–º—É –≤—Å–µ—Ö `w` –≤–∑—è—Ç—ã—Ö –ø–æ –º–æ–¥—É–ª—é. –û–Ω–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –±—ã—Å—Ç—Ä–µ–µ *L2* –∑–∞ —Å—á–µ—Ç –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–µ–Ω—É–∂–Ω—ã—Ö (—Å —Ç–æ—á–∫–∏ –∑—Ä–µ–Ω–∏—è –º–æ–¥–µ–ª–∏) –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

![](./images/reg-L1.png)

##### L1 –Ω–∞ python

```python
from sklearn import linear_model

lasso_lr_poly = linear_model.Lasso(alpha=0.1)
lasso_lr_poly.fit(X_train_scaled_poly, y_train)
```

#### L2-—Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è (Ridge)

–î–∞–Ω–Ω–∞—è –†. –¥–æ–±–∞–≤–ª—è–µ—Ç —Å—É–º–º—É –≤—Å–µ—Ö `w`, –≤–æ–∑–≤–µ–¥–µ–Ω–Ω—ã—Ö –≤ –∫–≤–∞–¥—Ä–∞—Ç.

![](./images/reg-L2.png)

##### L2 –Ω–∞ python

```python
from sklearn import linear_model

ridge_lr_poly = linear_model.Ridge(alpha=10)
ridge_lr_poly.fit(X_train_scaled_poly, y_train)
```

#### –ö–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏

–ü—Ä–∏ –≤–Ω–µ—Å–µ–Ω–∏–∏ —à—Ç—Ä–∞—Ñ–æ–≤ –≤ —Ñ—É–Ω–∫—Ü–∏—é –ø–æ—Ç–µ—Ä—å –º—ã –ø—Ä–∏–Ω—É–∂–¥–∞–µ–º –∞–ª–≥–æ—Ä–∏—Ç–º –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∏—Å–∫–∞—Ç—å –Ω–µ –∏—Å—Ç–∏–Ω–Ω—ã–π –º–∏–Ω–∏–º—É–º, –∞ *–ø—Å–µ–≤–¥–æ–º–∏–Ω–∏–º—É–º* –Ω–∞—à–µ–π –∏–∑–Ω–∞—á–∞–ª—å–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏. –ì–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–∏ –æ–Ω –±—É–¥–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞ –Ω–µ–∫–æ–º —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ –æ—Ç –∏—Å—Ç–∏–Ω–Ω–æ–≥–æ, –Ω–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–∏ MSE —Å —Ä–æ–º–±–æ–º (L1) –∏–ª–∏ —ç–ª–∏–ø—Å–æ–º (L2).

–í —É—Ä–∞–≤–Ω–µ–Ω–∏—è—Ö –≤—ã—à–µ `Œ±` ‚Äî —ç—Ç–æ **–∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏**. –û–Ω –∑–∞–¥–∞–µ—Ç *—Å–º–µ—â–µ–Ω–∏–µ* ‚Äî —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ, –Ω–∞ –∫–æ—Ç–æ—Ä–æ–µ –æ—Ç–æ–¥–≤–∏–Ω—É—Ç –ø—Å–µ–≤–¥–æ–º–∏–Ω–∏–º—É–º.

![](./images/dst3-ml2-5_9.png)

–ó–∞—Ä–∞–Ω–µ–µ –Ω–µ–ª—å–∑—è —Å–∫–∞–∑–∞—Ç—å, –∫–∞–∫–æ–π –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç `Œ±` –∏ –º–µ—Ç–æ–¥ (L1 –∏–ª–∏ L2) –¥–∞–¥—É—Ç –ª—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

#### –≠–ª–∞—Å—Ç–∏—á–Ω–∞—è —Å–µ—Ç–∫–∞

–≠—Ç–æ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è, –∫–æ–º–±–∏–Ω–∏—Ä—É—é—â–∞—è Lasso –∏ Ridge.

![](./images/elastic-net.png)

–û–Ω–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–≤–∞ –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏ ‚Äî `Œ±` –∏ `∆õ`. –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ä–µ–¥–∫–æ, –ø–æ—Å–∫–æ–ª—å–∫—É —Ç—Ä—É–¥–Ω–æ –ø–æ–¥–æ–±—Ä–∞—Ç—å –∏—Ö –æ–ø—Ç–∏–º–∞–ª—å–Ω—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é.

## Supervised learning / Classification

### Logistic regression

#### –ó–∞–¥–∞—á–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

**–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è** —ç—Ç–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ *—Ç–∏–ø–∞* –æ–±—ä–µ–∫—Ç–∞ –ø–æ –µ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞–º. –ï—Å–ª–∏ –≤ –∑–∞–¥–∞—á–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ —Ü–µ–ª–µ–≤—ã–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º –±—ã–ª–æ —á–∏—Å–ª–æ, —Ç–æ –≤ –∑–∞–¥–∞—á–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ü–µ–ª–µ–≤—ã–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º —è–≤–ª—è–µ—Ç—Å—è –∫–∞—Ç–µ–≥–æ—Ä–∏—è –æ–±—ä–µ–∫—Ç–∞.

–í –∑–∞–¥–∞—á–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–ø–∏—Å–æ–∫ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –≤—Å–µ–≥–¥–∞ –∏–∑–≤–µ—Å—Ç–µ–Ω –∑–∞—Ä–∞–Ω–µ–µ. –ï—Å–ª–∏ —Ç–∞–∫–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–≤–µ, —Ç–æ —ç—Ç–æ **–±–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è** (binary classification), –∞ –µ—Å–ª–∏ –±–æ–ª—å—à–µ —Ç–æ **–º—É–ª—å—Ç–∏–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è** (multiclass classification).

#### –†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ (intuition)

–†–µ—à–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (–≤ –≥–µ–æ–º–µ—Ç—Ä–∏—á–µ—Å–∫–æ–º —Å–º—ã—Å–ª–µ) —Å–≤–æ–¥–∏—Ç—Å—è –∫ –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—é —Ç–∞–∫–æ–π –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä–∞—è —Ä–∞–∑–¥–µ–ª–∏—Ç –æ–±—ä–µ–∫—Ç—ã —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –ø–æ —Ä–∞–∑–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã —Å–µ–±—è. –¢–∞–∫–∞—è –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç—å ‚Äî –æ–Ω–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **—Ä–∞–∑–¥–µ–ª—è—é—â–∏–∞—è –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç—å** ‚Äî –±—É–¥–µ—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –≤ –ø—Ä–æ—Å—Ç—Ä–µ–Ω—Å—Ç–≤–µ —Å —Ä–∞–∑–º–µ—Ä–æ–º –Ω–∞ `1` –±–æ–ª—å—à–µ–º –∫–æ–ª-–≤–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –æ–±—ä–µ–∫—Ç–æ–≤. (–ï—Å–ª–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –¥–≤–∞, —Ç–æ —Å–∞–º–∏ –æ–±—ä–µ–∫—Ç—ã –º–æ–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –Ω–∞ –¥–≤—É—Ö–º–µ—Ä–Ω–æ–π –ø–ª–æ—Å–∫–æ—Å—Ç–∏, –∞ —Ä–∞–∑–¥–µ–ª—è—é—â–∞—è –∏—Ö –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç—å –±—É–¥–µ—Ç –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –≤ 3D –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–µ. –ù–∞ —Ä–∏—Å—É–Ω–∫–∞—Ö –Ω–∏–∂–µ –∑–µ–ª–µ–Ω—ã–º —Ü–≤–µ—Ç–æ–º –ø–æ–∫–∞–∑–∞–Ω–∞ –ª–∏–Ω–∏—è –ø–æ –∫–æ—Ç–æ—Ä–æ–π –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç—å –ø–µ—Ä–µ—Å–µ–∫–∞–µ—Ç –ø–ª–æ—Å–∫–æ—Å—Ç—å —Å –æ–±—ä–µ–∫—Ç–∞–º–∏.)

![](./images/dst3-ml3-2_1.png)

–í–∏–¥–Ω–æ —á—Ç–æ –∑–µ–ª–µ–Ω–∞—è –ª–∏–Ω–∏—è —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –æ–±—ä–µ–∫—Ç—ã —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤. –ß–µ–º –¥–∞–ª—å—à–µ –æ–±—ä–µ–∫—Ç –æ—Ç –≥—Ä–∞–Ω–∏—Ü—ã, —Ç–µ–º –≤—ã—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –µ–≥–æ –∫ —Å–≤–æ–µ–º—É —Ç–∏–ø—É. –û–±—ä–µ–∫—Ç—ã –≤–±–ª–∏–∑–∏ –≥—Ä–∞–Ω–∏—Ü—ã –±—É–¥—É—Ç –∏–º–µ—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —à–∞–Ω—Å—ã –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç—å –∫ –ª—é–±–æ–π –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–π.

–≠—Ç–∏ —à–∞–Ω—Å—ã –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ—Å—á–∏—Ç–∞—Ç—å –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏, –ø–æ—Å—Ç—Ä–æ–∏–≤ –ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä –æ—Ç –æ–±—ä–µ–∫—Ç–∞ –Ω–∞ –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç—å. –¢–æ—á–∫–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –±—É–¥–µ—Ç –∏–º–µ—Ç—å —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (–ø–æ –æ—Å–∏ Z –¥–ª—è —Å–ª—É—á–∞—è –Ω–∞ —Ä–∏—Å—É–Ω–∫–∞—Ö –≤—ã—à–µ). –ï—Å–ª–∏ –æ–Ω–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–µ, —Ç–æ –æ–±—ä–µ–∫—Ç –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –∞ –µ—Å–ª–∏ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ, —Ç–æ –∫ –¥—Ä—É–≥–æ–π.

–°–æ –∑–Ω–∞–∫–æ–º –ø–æ–Ω—è—Ç–Ω–æ, –Ω–æ –∫–∞–∫ –æ—Ü–µ–Ω–∏—Ç—å –≤–µ–ª–∏—á–∏–Ω—É —ç—Ç–æ–≥–æ —á–∏—Å–ª–∞? –ï—Å—Ç—å –ª–∏ —Å–ø–æ—Å–æ–± –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –µ–≥–æ –≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –æ–±—ä–µ–∫—Ç–∞ –∫ —Å–≤–æ–µ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏?

#### –°–∏–≥–º–æ–∏–¥–∞

–≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–¥–µ–ª–∞—Ç—å **–ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è** ‚Äî –æ–Ω–∞ –ø–æ–ª—É—á–∞–µ—Ç —á–∏—Å–ª–æ –æ—Ç `-‚àû` –¥–æ `+‚àû` –∏ –ø—Ä–µ–≤—Ä–∞—â–∞–µ—Ç –µ–≥–æ –≤ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —á–∏—Å–ª–æ –æ—Ç `0` –¥–æ `1`. –û–Ω–∞ —Ç–∞–∫–∂–µ –∏–∑–≤–µ—Å—Ç–Ω–∞ –ø–æ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º **—Å–∏–≥–º–æ–∏–¥–∞**.

![](./images/sigmoid.png)

–ì—Ä–∞—Ñ–∏–∫ —Ñ—É–Ω–∫—Ü–∏–∏ –≤—ã–≥–ª—è–¥–∏—Ç —Ç–∞–∫.

![](./images/dst3-ml3-2_3.png)

–î–∞–ª–µ–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–≤–∞—é—Ç –∫ –æ—Ç–≤–µ—Ç—É –æ –ø—Ä–∏–Ω–∞–¥–ª–∂–µ–Ω–æ—Å—Ç–∏ –∫ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏–ª–∏ –∫ –¥—Ä—É–≥–æ–π —Å –ø–æ–º–æ—â—å—é **–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏**

![](./images/indicator-func.png)

#### –õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è

–ü–æ—Å–∫–æ–ª—å–∫—É –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞–º –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –≥–∏–ø–µ—Ä–ø–ª–æ—Å–∫–æ—Å—Ç—å, —Ç–æ –∑–Ω–∞—á–∏—Ç –º—ã –º–æ–∂–µ–º –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –µ–µ –≤ –∑–∞–¥–∞—á—É —Ä–µ–≥—Ä–µ—Å—Å–∏–∏. **–õ–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è** (logistic regression) ‚Äî —ç—Ç–æ –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ—à–∞–µ—Ç –¥–∞–Ω–Ω—É—é –∑–∞–¥–∞—á—É: –ø–æ–ª—É—á–∞–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–∏ –æ–±—ä–µ–∫—Ç–∞ –∏ –≤—ã—á–∏—Å–ª—è–µ—Ç –≤–µ–æ—Ä—è—Ç–Ω–æ—Å—Ç—å –µ–≥–æ –ø—Ä–∏–Ω–∞–¥–ª–∂–µ–Ω–æ—Å—Ç–∏ –∫ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. (–°–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–Ω–∞ –ø–æ–ª—É—á–∏–ª–∞ –æ—Ç –Ω–∞–∑—ã–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–π –≤ –Ω–µ–π –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.)

–î–ª—è –æ–±—É—á–µ–Ω–∏—è –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –Ω—É–∂–Ω–∞ –±—É–¥–µ—Ç —Ç–∞–∫–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å, –∫–æ—Ç–æ—Ä–∞—è –æ–±–µ—Å–ø–µ—á–∏—Ç –Ω–∞–∏–ª—É—á—à—É—é –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å `P`. –û–Ω–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è**.

#### –ü–æ–∏—Å–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏

–ü—Ä–∏ –ø–æ–∏—Å–∫–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –Ω–∞—à–∞ —Ñ—É–Ω–∫—Ü–∏—è –æ—à–∏–±–∫–∏ –±–∞–∑–∏—Ä–æ–≤–∞–ª–∞—Å—å –Ω–∞ MSE. –í –¥–∞–Ω–Ω–æ–º —Å–ª—É—á–∞–µ –º—ã –¥–æ–ª–∂–Ω—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –ø–æ–¥—Ö–æ–¥: MLE ‚Äî **–ú–µ—Ç–æ–¥ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è** (Maximum Likelihood Estimation).

–¶–µ–ª—å –º–µ—Ç–æ–¥–∞ ‚Äî –ø–æ–¥–æ–±—Ä–∞—Ç—å —Ç–∞–∫–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `w`, –ø—Ä–∏ –∫–æ—Ç–æ—Ä—ã—Ö –æ—Ü–µ–Ω–∫–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è `x` –±—É–¥–µ—Ç –Ω–∞–∏–±–æ–ª–µ–µ –±–ª–∏–∑–∫–∞ –∫ `y` (–∫ –Ω—É–ª—é –∏–ª–∏ –∫ –µ–¥–∏–Ω–∏—Ü–µ).

–ß—Ç–æ–±—ã –¥–æ–±–∏—Ç—å—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –º–∞–∫—Å–∏–º—É–º **—Ñ—É–Ω–∫—Ü–∏–∏ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è**

![](./images/likelyhood-func.png)

–ß—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏, –µ–µ –Ω—É–∂–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –≤ —Ñ—É–Ω–∫—Ü–∏—é –æ—à–∏–±–∫–∏, –∫–æ—Ç–æ—Ä—É—é –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å. –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ —É–º–Ω–æ–∂–∏—Ç—å –µ–µ –Ω–∞ `-1`.

![](./images/logless-func.png)

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º—ã –ø–æ–ª—É—á–∏–ª–∏ **—Ñ—É–Ω–∫—Ü–∏—é –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ—Ç–µ—Ä—å** (logless).

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–ª—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

–í –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤–æ–∑–º–æ–∂–Ω—ã —á–µ—Ç—ã—Ä–µ –∏—Å—Ö–æ–¥–∞. –û–Ω–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω—ã –≤ **–º–∞—Ç—Ä–∏—Ü–µ –æ—à–∏–±–æ–∫** (confusion matrix) –Ω–∏–∂–µ.

![](./images/confusion-matrix.png)

–ò–Ω–∞—á–µ –∏—Ö –º–æ–∂–Ω–æ –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å —Ç–∞–∫.

![](./images/tp-fp-fn-tn.png)

–í—Å–µ –ª–µ–≤–æ–π –ø–æ–ª–æ–≤–∏–Ω–µ —Ä–µ–∞–ª—å–Ω—ã–µ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å—Ö–æ–¥—ã, –≤ –ø—Ä–∞–≤–æ–π —Ä–µ–∞–ª—å–Ω—ã–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ; –º–æ–¥–µ–ª—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å—Ö–æ–¥—ã –≤ —Ü–µ–Ω—Ç–∞—Ä–ª—å–Ω–æ–º –∫—Ä—É–≥–µ, –∞ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ ‚Äî –∑–∞ –µ–≥–æ –ø—Ä–µ–¥–µ–ª–∞–º–∏.

#### Accuracy

**–î–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å** (accuracy) –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–æ–ª—é –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –º–æ–¥–µ–ª–∏. –ù–æ(!) –µ–µ –Ω–µ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª –ø—Ä–∏–º–µ–Ω—è—Ç—å –µ—Å–ª–∏ –µ—Å—Ç—å —Å–∏–ª—å–Ω—ã–π –¥–∏—Å–±–∞–ª–∞–Ω—Å –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö (–æ–±—ä–µ–∫—Ç–æ–≤ –æ–¥–Ω–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –º–µ–Ω—å—à–µ, —á–µ–º –æ–±—ä–µ–∫—Ç–æ–≤ –¥—Ä—É–≥–æ–π).

![](./images/accuracy.png)

#### Precision

**–¢–æ—á–Ω–æ—Å—Ç—å** (precision) –∏–ª–∏ **PPV** (Positive Predictive Value) –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ç–æ—á–Ω–æ –º–æ–¥–µ–ª—å –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å—Ö–æ–¥—ã.

![](./images/precision.png)

![](./images/precision-intuition.png)

–≠—Ç–∞ –º–µ—Ç—Ä–∏–∫–∞ —Ü–µ–Ω–Ω–∞ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –≤–∞–∂–Ω–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ª–æ–∂–Ω–æ-–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ –∏—Ö —Ü–µ–Ω–∞ –≤—ã—Å–æ–∫–∞. (–ù–∞–ø—Ä–∏–º–µ—Ä –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –¥—Ä–∞–∫—É –ø–æ –∫–∞—Ä—Ç–∏–Ω–∫–µ —Å –∫–∞–º–µ—Ä—ã –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏—è, —á—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞—Ä—è–¥ –ø–æ–ª–∏—Ü–∏–∏.)

#### Recall

**–ü–æ–ª–Ω–æ—Ç–∞** (recall) –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–∞–∫—É—é –¥–æ–ª—é –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –∏—Å—Ö–æ–¥–æ–≤ –º–æ–¥–µ–ª—å —Å–ø–æ—Å–æ–±–Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å.

![](./images/recall.png)

![](./images/recall-intuition.png)

–î–∞–Ω–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ –≤–∞–∂–Ω–∞ —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ –≤–∞–∂–Ω–æ –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π –∏—Å—Ö–æ–¥. (–ù–∞–ø—Ä–∏–º–µ—Ä –Ω–∞–π—Ç–∏ –≤—Å–µ—Ö –±–æ–ª—å–Ω—ã—Ö –≤–∏—Ä—É—Å–Ω–æ–π –∏–Ω—Ñ–µ–∫—Ü–∏–µ–π, —á—Ç–æ–±—ã –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç—å –µ–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç–∞–Ω–µ–Ω–∏–µ.)

#### F-score

Precision –∏ recall —Ä–∞–±–æ—Ç–∞—é—Ç –¥—Ä—É–≥ –ø—Ä–æ—Ç–∏–≤ –¥—Ä—É–≥–∞. –ß—Ç–æ–±—ã –∏—Ö —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞—Ç—å, –ø—Ä–∏–º–µ–Ω–µ—Ç—Å—è **F-–º–µ—Ä–∞** (F-score)

![](./images/f-score.png)

`Œ≤` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å precision –≤ –¥–∞–Ω–Ω–æ–π —Ñ–æ—Ä–º—É–ª–µ –∏ –º–æ–∂–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è `1` –∏ `2`.

![](./images/f1-score.png)

–î–∞–Ω–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ —Ö–æ—Ä–æ—à–∞ —Ç–µ–º, —á—Ç–æ –±—É–¥–µ—Ç –±–ª–∏–∑–∫–∞ –∫ –Ω—É–ª—é, –µ—Å–ª–∏ —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞ –∏–∑ —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏—Ö –µ–µ –º–µ—Ç—Ä–∏–∫ –±–ª–∏–∑–∫–∞ –∫ –Ω—É–ª—é.

#### –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫ –Ω–∞ python

```python
from sklearn import metrics
import seaborn as sns

confusion_matrix = metrics.confusion_matrix(y, y_pred)
sns.heatmap(confusion_matrix, annot=True)

print(f'Accuracy: {metrics.accuracy_score(y, y_pred)}')
print(f'Precision: {metrics.precision_score(y, y_pred)}')
print(f'Recall: {metrics.recall_score(y, y_pred)}')
print(f'F‚ÇÅ score: {metrics.f1_score(y, y_pred)}')

print(metrics.classification_report(y, y_pred))
```

### –ú—É–ª—å—Ç–∏–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è

–ï—Å–ª–∏ –∫–ª–∞—Å—Å–æ–≤ –±–æ–ª—å—à–µ –¥–≤—É—Ö, —Ç–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞ —Å—Ç—Ä–æ—è—Ç –±–∏–Ω–∞—Ä–Ω—É—é –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—é, –≤ –∫–æ—Ç–æ—Ä–æ–π –≤—Å–µ –¥—Ä—É–≥–∏–µ –∫–ª–∞—Å—Å—ã –æ–±—ä–µ–¥–∏–Ω–µ–Ω—ã –≤ "–¥—Ä—É–≥–æ–π –∫–ª–∞—Å—Å". –¢–∞–∫–æ–π –ø–æ–¥—Ö–æ–¥ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–æ–¥–∏–Ω –ø—Ä–æ—Ç–∏–≤ –≤—Å–µ—Ö** (one-vs-over). –ü–æ–±–µ–∂–¥–∞–µ—Ç —Ç–æ—Ç –∫–ª–∞—Å—Å, —á–µ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –≤—ã—à–µ –¥—Ä—É–≥–∏—Ö.

![](./images/dst3-ml3-3_9.png)

–ß—Ç–æ–±—ã –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∫–∞–∂–¥–æ–π –º–æ–¥–µ–ª–∏ –≤ –æ—Ü–µ–Ω–∫—É –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è `softmax` ‚Äî –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–æ–≥ —Å–∏–≥–º–æ–∏–¥—ã. –û–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç *–Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏* (–≤ —Å—É–º–º–µ –¥–∞—é—â–∏–µ –µ–¥–∏–Ω–∏—Ü—É).

![](./images/softmax.png)

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from sklearn import linear_model

log_reg = linear_model.LogisticRegression(
    # penalty='l1',
    # C=10, # –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –æ–±—Ä–∞—Ç–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—É —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–∏
    # random_state=42,
    # max_iter=1000,
    # solver='sag', # —á–∏—Å–ª–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –ø–æ—Ç–µ—Ä—å
    multi_class='multinomial', # –º—É–ª—å—Ç–∏–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
)

# –æ–±—É—á–∞–µ–º
log_reg.fit(X, y)

# –≤—ã–≤–æ–¥–∏–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Å–∞
log_reg.predict_proba(x)

# —á—Ç–æ–±—ã –ø–æ–Ω–∏–º–∞—Ç—å –∫–∞–∫–æ–π –∏–Ω–¥–µ–∫—Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –∫–∞–∫–æ–º—É –∫–ª–∞—Å—Å—É:
log_reg.classes_
```

#### –ü–ª—é—Å—ã –∏ –º–∏–Ω—É—Å—ã

Logistic regression –ø—Ä–∏–º–µ–Ω—è—é—Ç –¥–ª—è –º—É–ª—å—Ç–∏–∫–ª–∞—Å—Å–æ–≤–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å. –£ –Ω–µ–≥–æ –º–∞—Å—Å–∞ –¥–æ—Å—Ç–æ–∏–Ω—Å—Ç–≤:

- –ø—Ä–æ—Å—Ç–æ–π –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º—ã–π,
- –±—ã—Å—Ç—Ä–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –º–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å–æ–≤
- –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤.

–£ –Ω–µ–≥–æ –µ—Å—Ç—å –æ–¥–∏–Ω –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫: –µ—Å–ª–∏ –∫–ª–∞—Å—Å—ã –Ω–µ–ª—å–∑—è —Ä–∞–∑–¥–µ–ª–∏—Ç—å –ª–∏–Ω–µ–π–Ω–æ (–≤ —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö —Ç–∞–∫ —á–∞—â–µ –≤—Å–µ–≥–æ –∏ –±—ã–≤–∞–µ—Ç), —Ç–æ –º–µ—Ç–æ–¥ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–ª–æ—Ö–æ. (–≠—Ç—É –ø—Ä–æ–±–ª–µ–º—É –º–æ–∂–Ω–æ —Ä–µ—à–∏—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º –ø–æ–ª–∏–Ω–æ–º–∏–∞–ª—å–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –Ω–æ —Ç–æ–≥–¥–∞ –ø—Ä–∏–¥–µ—Ç—Å—è –±–æ—Ä–æ—Ç—å—Å—è —Å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ–º.)

### Decision tree

#### –°—É—Ç—å

**–î–µ—Ä–µ–≤—å—è —Ä–µ—à–µ–Ω–∏–π** ‚Äî —Å–µ–º–µ–π—Å—Ç–≤–æ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ ML. –° –ø–æ–º–æ—â—å—é –º–æ–¥–µ–ª–µ–π –Ω–∞ –∏—Ö –æ—Å–Ω–æ–≤–µ –º–æ–∂–Ω–æ —Ä–µ—à–∞—Ç—å –∑–∞–¥–∞—á–∏ –∫–∞–∫ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏, —Ç–∞–∫ –∏ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏. –û–Ω–∏ –ø–æ–∑–≤–æ–ª—è—é—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫ —Å –ø–æ–º–æ—â—å—é –≤–æ–ø—Ä–æ—Å–æ–≤ –∫ –∏–º–µ—é—â–∏–º—Å—è —Ñ–∞–∫—Ç–æ—Ä–∞–º.

–ù–∏–∂–µ –¥–∞–Ω –ø—Ä–∏–º–µ—Ä –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–≥–∞—Ç —Å—Ç—Ä–∞—Ö–æ–≤–æ–º—É –∞–≥–µ–Ω—Ç—É –ø—Ä–∏–Ω—è—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.

![](./images/dst3-ml3-5_1.png)


–ù–∞ –∫–∞–∂–¥–æ–π –∏—Ç–µ—Ä–∞—Ü–∏–∏ —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø—Ä–æ—Å—Ç–æ–≥–æ –ø—Ä–∞–≤–∏–ª–∞. –û–Ω–æ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **—Ä–µ—à–∞—é—â–µ–µ –ø—Ä–∞–≤–∏–ª–æ** –∏–ª–∏ **–ø—Ä–µ–¥–∏–∫–∞—Ç** (predicate condition).

#### –°—Ç—Ä–æ–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞

–ü–æ —Ç–æ–ø–æ–ª–æ–≥–∏–∏ –¥–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π ‚Äî —ç—Ç–æ **—Å–≤—è–∑–Ω—ã–π –∞—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π –≥—Ä–∞—Ñ** ‚Äî¬†—Ç–∞–∫–æ–π, –≥–¥–µ –≤—Å–µ –≤–µ—Ä—à–∏–Ω—ã —Å–≤—è–∑–∞–Ω—ã –º–µ–∂–¥—É —Å–æ–±–æ–π –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π —Å–≤—è–∑—å—é (—Å–≤—è–∑–Ω—ã–π) –∏ –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ –∏–º–µ—é—â–∏–π –∑–∞—Ü–∏–∫–ª–∏–≤–∞–Ω–∏–π (–∞—Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–π).

![](./images/dst3-ml3-5_2.png)

–û–Ω –∏–º–µ–µ—Ç —Ç—Ä–∏ —Ç–∏–ø–∞ –≤–µ—Ä—à–∏–Ω:
- **–∫–æ—Ä–Ω–µ–≤–∞—è –≤–µ—Ä—à–∏–Ω–∞**,
- **–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –≤–µ—Ä—à–∏–Ω—ã**,
- **–ª–∏—Å—Ç—å—è**.

![](./images/dst3-ml3-5_3.png)

**–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤–∞** (max depth) ‚Äî —ç—Ç–æ –∫–æ–ª-–≤–æ —Ä–µ–±–µ—Ä –≤ —Å–∞–º–æ–π –¥–ª–∏–Ω–Ω–æ–π —Ü–µ–ø–æ—á–∫–µ –≥—Ä–∞—Ñ–∞.

#### –ê–ª–≥–æ—Ä–∏—Ç–º –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è

–°—É—â–µ—Å—Ç–≤—É—é—Ç —Ä–∞–∑–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞ —Ä–µ—à–µ–Ω–∏–π. –ß–∞—Å—Ç—å –∏–∑ –Ω–∏—Ö [—Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ sklearn](https://scikit-learn.ru/1-10-decision-trees/#tree-algorithms-id3-c4-5-c5-0-and-cart). –ú—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –∞–ª–≥–æ—Ä–∏—Ç–º *CART* (Classification and Regression Tree)

–î–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–µ—Ä–µ–≤–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è. –ü—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ –æ–Ω–∞ —Å–æ–∑–¥–∞–µ—Ç –≤–µ—Ä—à–∏–Ω—É. –ï—Å–ª–∏ –≤–µ—Ä—à–∏–Ω–∞ –∫–æ–Ω–µ—á–Ω–∞—è (–ª–∏—Å—Ç), —Ç–æ –æ–Ω–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–µ—Ä—à–∏–Ω—É. –ò–Ω–∞—á–µ –æ–Ω–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–µ–±—è –¥–≤–∞–∂–¥—ã —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å –¥–≤–µ –¥–æ—á–µ—Ä–Ω–∏–µ –≤–µ—Ä—à–∏–Ω—ã, –ª–µ–≤—É—é –∏ –ø—Ä–∞–≤—É—é.

##### –ê–±—Å—Ç—Ä–∞–∫—Ç–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
def build_decision_tree(X, y):
    node = Node()
    if stopping_criterion(X, y) is True:
        node = create_leaf_with_prediction(y)
        return node 
    else:
        X_left, y_left, X_rigth, y_rigth = best_split(X, y)
        node.left = build_decision_tree(X_left, y_left)
        node.right = build_decision_tree(X_rigth, y_rigth)
```

–í —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –≤—ã—à–µ `stopping_criterion` –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å `True` –µ—Å–ª–∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –∫ –æ–¥–Ω–æ–º—É –∫–ª–∞—Å—Å—É –∏–ª–∏ –µ—Å–ª–∏ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞.

–°–∞–º–æ–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `best_split`. –í –Ω–µ–π –ø–µ—Ä–µ–±–∏—Ä–∞—é—Ç—Å—è –≤—Å–µ —Ñ–∞–∫—Ç–æ—Ä—ã, –∞ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–∞–∫—Ç–æ—Ä–∞ –ø–µ—Ä–µ–±–∏—Ä–∞—é—Ç—Å—è –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–æ—Ç min –¥–æ max —Å –∫–∞–∫–∏–º —Ç–æ —à–∞–≥–æ–º). –ò–∑ –≤—Å–µ—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π —Ñ–∞–∫—Ç–æ—Ä–æ–≤ –∏ –∏—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è —Ç–∞ –ø–∞—Ä–∞, –∫–æ—Ç–æ—Ä–∞—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–∞–ª—å–Ω–µ–π—à–µ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ *–Ω–∞–∏–ª—É—á—à–∏–º –æ–±—Ä–∞–∑–æ–º*.

#### –ü–æ–∏—Å–∫ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –≤–µ—Ä—à–∏–Ω –¥–µ—Ä–µ–≤–∞

–î–ª—è –∫–∞–∂–¥–æ–π –≤–µ—Ä—à–∏–Ω—ã –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã `j` (–∏–Ω–¥–µ–∫—Å —Ñ–∞–∫—Ç–æ—Ä–∞) –∏ `t` (–ø–æ—Ä–æ–≥–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ) –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–∏.

![](./images/predicate.png)

–ó–Ω–∞—á–µ–Ω–∏–µ –ø—Ä–µ–¥–∏–∫–∞—Ç–∞ –¥–ª—è –≤–µ—Ä—à–∏–Ω—ã `v` –±—É–¥–µ—Ç –µ–¥–∏–Ω–∏—Ü–µ–π –µ—Å–ª–∏ –∏–∑ –≤—Å–µ—Ö –ø–µ—Ä–µ–¥–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π —Ñ–∞–∫—Ç–æ—Ä–æ–≤ `x` –∏–º–µ–Ω–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ `j`-—Ç–æ–≥–æ —Ñ–∞–∫—Ç–æ—Ä–∞ –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ `t`.

–ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ `j` –∏ `t` –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `L(j,t)`

![](./images/l-min-func.png)

–ó–¥–µ—Å—å `n·µ•` ‚Äî –∫–æ–ª-–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø—Ä–∏—à–µ–¥—à–∏—Ö –≤ –≤–µ—Ä—à–∏–Ω—É, –∞ `H(Q)` ‚Äî¬†**–∫—Ä–∏—Ç–µ—Ä–∏–π –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏**. –ö—Ä–∏—Ç–µ—Ä–∏–∏ (–ª–µ–≤—ã–π –∏ –ø—Ä–∞–≤—ã–π) –±—É–¥—É—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å—Å—è –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–æ–≥–æ –≤ –∫–∞–∫–∏—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏—è —Ä–∞–∑–¥–µ–ª—è—Ç—Å—è —ç–ª–µ–º–µ–Ω—Ç—ã.

#### –ö—Ä–∏—Ç–µ—Ä–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏

**–≠–Ω—Ç—Ä–æ–ø–∏—è –®–µ–Ω–Ω–æ–Ω–∞** (Shannon entropy)

![](./images/shannon-entropy.png)

–ó–¥–µ—Å—å –∏ –Ω–∏–∂–µ `k` ‚Äî —ç—Ç–æ –≤—Å–µ –∫–ª–∞—Å—Å—ã, a `P·µ¢` ‚Äî –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ `Q` —ç–ª–µ–º–µ–Ω—Ç–æ–≤ (–≤—Å–µ—Ö) –∫ `i`-–º—É –∫–ª–∞—Å—Å—É.

**–ö—Ä–∏—Ç–µ—Ä–∏–π –î–∂–∏–Ω–∏** (Gini coefficient)

![](./images/gini-coefficient.png)

–§—É–Ω–∫—Ü–∏–∏ `PÔΩ•log‚ÇÇP` –∏ `PÔΩ•(1 - P)` –ø–æ—Ö–æ–∂–∏ –ø–æ —Ñ–æ—Ä–º–µ, –Ω–æ –æ—Ç–ª–∏—á–∞—é—Ç—Å—è –ø–æ –∑–Ω–∞–∫—É. –û–±–µ –¥–æ—Å—Ç–∏–≥–∞—é—Ç –º–∏–Ω–∏–º—É–º–∞ –∫–æ–≥–¥–∞ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –∫ –æ–¥–Ω–æ–º—É –∫–ª–∞—Å—Å—É.

![](./images/desmos.png)

#### –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

–ú–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–µ—Ä–µ–≤–∞ —Ä–µ—à–µ–Ω–∏–π –∏–º–µ—é—Ç —Ö–æ—Ä–æ—à—É—é –æ–±–æ–±—â–∞—é—â—É—é —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –∏ —Å–ø–æ—Å–æ–±–Ω—ã —Å–æ—Å—Ç—è–∑–∞—Ç—å—Å—è —Å –º–æ–¥–µ–ª—è–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª–æ–≥–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏. –ù–æ –≤–∞–∂–Ω–æ –Ω–µ –ø–µ—Ä–µ–æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å! –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –≤—Å–µ–≥–¥–∞ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å –µ–µ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ —Å –ø–æ–º–æ—â—å—é –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤:
- `max_depth`
- `min_samples_leaf` (–º–∏–Ω. –∫–æ–ª-–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –ª–∏—Å—Ç–µ)

#### –ó–Ω–∞—á–∏–º–æ—Å—Ç—å (–≤–∞–∂–Ω–æ—Å—Ç—å) –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–ú–æ–¥–µ–ª–∏ –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–µ—Ä–µ–≤–∞ —Ä–µ—à–µ–Ω–∏–π –æ–±–ª–∞–¥–∞—é—Ç –µ—â–µ –æ–¥–Ω–∏–º –≤–∞–∂–Ω—ã–º –∫–∞—á–µ—Å—Ç–≤–æ–º ‚Äî –æ–Ω–∏ —É–º–µ—é—Ç –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å **–∑–Ω–∞—á–∏–º–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤** (feature importance). –≠—Ç–∏–º –∏—Ö —Å–≤–æ–π—Å—Ç–≤–æ–º –ø–æ–ª—å–∑—É—é—Ç—Å—è –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è —Å–∞–º—ã—Ö –≤–∞–∂–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –∫–æ–≥–¥–∞ –∏—Ö –∫–æ–ª-–≤–æ —Å–ª–∏—à–∫–æ–º –±–æ–ª—å—à–æ–µ –∏ –º–æ–∂–µ—Ç —Å–∏–ª—å–Ω–æ –∑–∞–º–µ–¥–ª–∏—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –æ–±—É—á–µ–Ω–∏—è.

–î–∞–Ω–Ω—ã–µ –æ –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Å–≤–æ–π—Å—Ç–≤–µ `feature_importances_` –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏. –≠—Ç–æ –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏, –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–µ —á–∏—Å–ª–∞ –æ—Ç `0` –¥–æ `1` (–∏—Ö —Å—É–º–º–∞ —Ä–∞–≤–Ω–∞ –µ–¥–∏–Ω–∏—Ü–µ).

–î–ª—è –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–Ω–∞—á–∏–º–æ—Å—Ç–∏ –º–æ–¥–µ–ª—å —É—á–∏—Ç—ã–≤–∞–µ—Ç —Å–ª–æ–∂–Ω—ã–µ –Ω–µ–ª–∏–Ω–µ–π–Ω—ã–µ —Å–≤—è–∑–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –º–æ–≥—É—Ç –±—ã—Ç—å –≤—ã—á–∏—Å–ª–µ–Ω—ã —Å –ø–æ–º–æ—â—å—é –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏. (–ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç –ª–∏–Ω–µ–π–Ω–æ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ–∂–¥—É –¥–≤—É–º—è –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏.)

##### –ó–Ω–∞—á–∏–º–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω–∞ pythoon

```python
features_df = pd.DataFrame(
    data=[dt_clf_full.feature_importances_],
    columns=dt_clf_full.feature_names_in_,
)

sns.barplot(data=features_df)
```

![](./images/feat_importance.png)

#### Pros & cons

–ü–ª—é—Å—ã

- –ù–µ —Ç—Ä–µ–±—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∞—Ü–∏–∏/–Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –æ—á–∏—Å—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–ª—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å –∏–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ –ø–æ–Ω—è—Ç–Ω–∞
- –í—ã—á–∏—Å–ª—è–µ—Ç –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–ú–∏–Ω—É—Å—ã
- –î–æ–ª–≥–æ –æ–±—É—á–∞–µ—Ç—Å—è (–ø–æ—Ç–æ–º—É —á—Ç–æ –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç –≤—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏ –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è)
- –û–±—É—á–µ–Ω–∏–µ –∑–∞—Ç—Ä–∞—Ç–Ω–æ –Ω–µ —Ç–æ–ª—å–∫–æ –ø–æ –≤—Ä–µ–º–µ–Ω–∏, –Ω–æ –∏ –ø–æ —Ä–µ—Å—É—Ä—Å–∞–º
- –î–µ—Ä–µ–≤—å—è —Å–∫–ª–æ–Ω–Ω—ã –∫ –ø–µ—Ä–µ–æ–±—É—á–∞–µ–º–æ—Å—Ç–∏
- –ù–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
- –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã–º–∏ —á–∏—Å–ª–æ–≤—ã–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –¥–µ—Ä–µ–≤–æ –¥–µ–ª–∏—Ç –∏—Ö –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –∏ —Ç–µ—Ä—è–µ—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é. (–õ—É—á—à–µ —á–∏—Å–ª–æ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –∑–∞—Ä–∞–Ω–µ–µ.)

## –ê–Ω—Å–∞–º–±–ª–∏

### –û–±—â–µ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ

**–ê–Ω—Å–∞–º–±–ª–µ–≤—ã–µ –º–æ–¥–µ–ª–∏** –∏–ª–∏ –ø—Ä–æ—Å—Ç–æ **–∞–Ω—Å–∞–º–±–ª–∏** (ensembles) —ç—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–æ—Å—Ç—ã—Ö –º–æ–¥–µ–ª–µ–π, –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã—Ö –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –æ–¥–Ω–æ–π –∑–∞–¥–∞—á–∏.

–û–±—ã—á–Ω–æ –∏—Ö –ø—Ä–∏–º–µ–Ω—è—é—Ç —Ç–æ–≥–¥–∞, –∫–æ–≥–¥–∞ —É–∂–µ –µ—Å—Ç—å –æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å, –Ω–æ –Ω–∏–∫–∞–∫ –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç—Å—è —É–ª—É—á—à–∏—Ç—å –µ–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.

–ê–Ω—Å–∞–º–±–ª–∏ –æ—á–µ–Ω—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã –∏ —Å–æ—Ä–µ–≤–Ω—É—é—Ç—Å—è —Å –Ω–µ–π—Ä–æ—Å–µ—Ç—è–º–∏.

#### –°–ø–æ—Å–æ–±—ã –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è

–û–±—ä–µ–¥–∏–Ω—è—Ç—å –º–æ–¥–µ–ª–∏ –º–æ–∂–Ω–æ –ø–æ-—Ä–∞–∑–Ω–æ–º—É. –ù–∞–ø—Ä–∏–º–µ—Ä –æ–±—É—á–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ª–∏–Ω–µ–π–Ω—ã—Ö —Ä–µ–≥—Ä–µ—Å—Å–∏–π –∏ –∑–∞—Ç–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ –¥–µ—Ä–µ–≤–æ. –ù–æ —Å—É—â–µ—Å—Ç–≤—É—Ç —Ç—Ä–∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö —Å–ø–æ—Å–æ–±–∞.

- **–ë—ç–≥–≥–∏–Ω–≥** (bagging) ‚Äî *–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ* –æ–±—É—á–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ *–æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö* –º–æ–¥–µ–ª–µ–π; –∫–æ–Ω–µ—á–Ω—ã–º —Ä–µ—à–µ–Ω–∏–µ–º –±—É–¥–µ—Ç –∏—Ö —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.
- **–°—Ç—ç–∫–∏–Ω–≥** (stacking) ‚Äî *–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ* –æ–±—É—á–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ *—Ä–∞–∑–Ω—ã—Ö* –º–æ–¥–µ–ª–µ–π; –∏—Ö —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–æ–ª—É—á–∞–µ—Ç —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –º–æ–¥–µ–ª—å –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∫–æ–Ω–µ—á–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.
- **–ë—É—Å—Ç–∏–Ω–≥** (boosting) ‚Äî *–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ* –æ–±—É—á–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ *–æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö* –º–æ–¥–µ–ª–µ–π; –∫–∞–∂–¥–∞—è –Ω–æ–≤–∞—è –º–æ–¥–µ–ª—å —Ñ–æ–∫—É—Å–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –ø—Ä–∏–º–µ—Ä–∞—Ö, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –ø—Ä–µ–¥—ã–¥—É—â–∞—è –¥–æ–ø—É—Å—Ç–∏–ª–∞ –æ—à–∏–±–∫—É.

### –ë—ç–≥–≥–∏–Ω–≥

–í –æ—Å–Ω–æ–≤–µ –º–µ—Ç–æ–¥–∞ –ª–µ–∂–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ [bootstraping](https://en.wikipedia.org/wiki/Bootstrapping_(statistics)). –û–Ω –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏–∑ –≤—ã–±–æ—Ä–∫–∏ —Ä–∞–∑–º–µ—Ä–∞ `n` —Å–¥–µ–ª–∞—Ç—å `k` –≤—ã–±–æ—Ä–æ–∫ —Ä–∞–∑–º–µ—Ä–∞ `m` (–≥–¥–µ `m <= n`). –°–æ–≥–ª–∞—Å–Ω–æ —ç—Ç–æ–º—É –º–µ—Ç–æ–¥—É —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –≤ –≤—ã–±–æ—Ä–∫–∞—Ö –º–æ–≥—É—Ç –ø–æ–≤—Ç–æ—Ä—è—Ç—å—Å—è.

![](./images/bootstraping.png)

–î–∞–ª–µ–µ –º—ã –æ–±—É—á–∞–µ–º `k` *–æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö* –º–æ–¥–µ–ª–µ–π (base model) –Ω–∞ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –≤—ã–±–æ—Ä–∫–∞—Ö. –î–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –±–µ—Ä—É—Ç—Å—è —É—Å—Ä–µ–¥–Ω–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –≤—Å–µ—Ö –º–æ–¥–µ–ª–µ–π. (–í —Å–ª—É—á–∞–µ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è *–º–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω–æ–µ* –≥–æ–ª—Å–æ–≤–∞–Ω–∏–µ ‚Äî¬†–ø—Ä–∏–Ω—Ü–∏–ø –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞.)

![](./images/begging.png)

–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –º–æ–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ —Å–º–µ—â–µ–Ω–∏–µ (bias) —Ç–∞–∫–æ–π –∞–Ω—Å–∞–º–±–ª–∏–µ–≤–æ–π –º–æ–¥–µ–ª–∏ –Ω–µ –±–æ–ª—å—à–µ –ª—é–±–æ–π –∏–∑ —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏—Ö –µ–≥–æ –º–æ–¥–µ–ª–µ–π, —Ç–æ–≥–¥–∞ –∫–∞–∫ —Ä–∞–∑–±—Ä–æ—Å (variation) –Ω–∏–∂–µ –≤ `k` —Ä–∞–∑.

#### Random forest

**–°–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å** ‚Äî —Å–∞–º–∞—è —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –±–µ–≥–≥–∏–Ω–≥–∞. –í –∫–∞—á–µ—Å—Ç–≤–µ –±–∞–∑–æ–≤–æ–π –º–æ–¥–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π. –ü–æ–º–∏–º–æ –±—É—Ç—Å—Ä–∞–ø–∏–Ω–≥–∞ –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–∞–∫–∂–µ **–º–µ—Ç–æ–¥ —Å–ª—É—á–∞–π–Ω—ã—Ö –ø–æ–¥–ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤** (random subspace method), –ø–æ–∑–≤–æ–ª—è—é—â–∏–π —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ–º–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤ –º–æ–¥–µ–ª–µ–π. –°—É—Ç—å –º–µ—Ç–æ–¥–∞ –≤ —Ç–æ–º, —á—Ç–æ–±—ã –∫–∞–∂–¥–∞—è –≤—ã–±–æ—Ä–∫–∞ –æ–±—É—á–∞–ª–∞—Å—å –Ω–µ –Ω–∞ –≤—Å–µ—Ö —Ñ–∞–∫—Ç–æ—Ä–∞—Ö, –∞ –ª–∏—à—å –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö, –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º.

–î–æ–ø—É—Å—Ç–∏–º —É –Ω–∞—Å –µ—Å—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ä–∞–∑–º–µ—Ä–æ–º `N √ó M`, —Ç–æ–≥–¥–∞ –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è `K` –¥–µ—Ä–µ–≤—å–µ–≤ —Ç–∞–∫–æ–≤.

1. –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å `K` —Å–µ—Ç–æ–≤ —Ä–∞–∑–º–µ—Ä–æ–º `N √ó M` (—Ä–∞–∑–º–µ—Ä—ã —Å–µ—Ç–æ–≤ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å —Ä–∞–∑–º–µ—Ä–æ–º –∏—Å—Ö–æ–¥–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏).
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ç–∞ –≤—ã–±—Ä–∞—Ç—å —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º `L` –∫—Ä–∏—Ç–µ—Ä–∏–µ–≤ (`L < M`) –∏ —É–±—Ä–∞—Ç—å –ª–∏—à–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏–ª–∏—Å—å —Å–µ—Ç—ã —Ä–∞–∑–º–µ—Ä–æ–º `N √ó L`.
3. –ù–∞ –∫–∞–∂–¥–æ–º —Å–µ—Ç–µ –æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å.

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from sklearn import ensemble

rf_clf = ensemble.RandomForestClassifier(
    n_estimators=500, # —á–∏—Å–ª–æ –¥–µ—Ä–µ–≤—å–µ–≤
    criterion='entropy', # –∫—Ä–∏—Ç–µ—Ä–∏–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    max_depth=3, # –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤–∞
    max_features='sqrt', # —á–∏—Å–ª–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
    random_state=42 # –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª
)
```

## Unsupervised learning / Clustering

### Overview

–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Ö–æ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ –≤ *–∫–ª–∞—Å—Ç–µ—Ä—ã*. –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ ‚Äî —ç—Ç–æ —Ñ—Ä—É–∫—Ç–æ–≤—ã–π —Å–∞–ª–∞—Ç, —Ç–æ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–∫–∞–∂–µ—Ç, –∏–∑ —á–µ–≥–æ –æ–Ω —Å–æ—Å—Ç–æ–∏—Ç.

![](./images/dst3-ml4-1_1.png)

–£ –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ –µ—Å—Ç—å —Å–≤–æ–π —Ü–µ–Ω—Ç—Ä –º–∞—Å—Å—ã ‚Äî **—Ü–µ–Ω—Ç—Ä–æ–∏–¥**. –ß—Ç–æ–±—ã –µ–≥–æ –ø–æ—Å—á–∏—Ç–∞—Ç—å –Ω—É–∂–Ω–æ –Ω–∞–π—Ç–∏ —Å—Ä–µ–¥–Ω–µ–µ –ø–æ –∫–∞–∂–¥–æ–π –æ—Å–∏.

![](./images/dst3-ml4-2_1.png)

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –æ—Å–Ω–æ–≤–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏.

### Expectation-maximization

EM-–∞–ª–≥–æ—Ä–∏—Ç–º—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–∞–∫ –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–æ—Å—Ç–æ—è—Ç –∏–∑ –¥–≤—É—Ö —à–∞–≥–æ–≤:

1. –ù–∞ —à–∞–≥–µ **E**xpectation –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç –∫ –∫–∞–∫–æ–º—É –∫–ª–∞—Å—Ç–µ—Ä—É –æ—Ç–Ω–æ—Å—è—Ç—Å—è —ç–ª–µ–º–µ–Ω—Ç—ã.
2. –ù–∞ —à–∞–≥–µ **M**aximization –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è.

–ú—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –¥–≤–∞ EM-–∞–ª–≥–æ—Ä–∏—Ç–º–∞: *K-means* –∏ *–º–æ–¥–µ–ª—å –ì–∞—É—Å—Å–æ–≤–æ–π —Å–º–µ—Å–∏*

### K-Means

–≠—Ç–æ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –±—ã–ª —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω 1950-—Ö, –Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–æ —Å–∏—Ö –ø–æ—Ä –∏–∑-–∑–∞ —Å–≤–æ–µ–π –≤—ã—Å–æ–∫–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏. –î–ª—è –µ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∑–∞—Ä–∞–Ω–µ–µ *–Ω—É–∂–Ω–æ –∑–Ω–∞—Ç—å —Å–∫–æ–ª—å–∫–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤* –±—É–¥–µ—Ç.

#### –°—É—Ç—å –º–µ—Ç–æ–¥–∞

–ù–µ—Å–∫–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º –≤—ã–±–∏—Ä–∞—é—Ç—Å—è —Ü–µ–Ω—Ç—Ä–æ–∏–¥–∞–º–∏. –ó–∞—Ç–µ–º –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –ø—Ä–∏–∫—Ä–µ–ø–ª—è—é—Ç—Å—è –∫ –±–ª–∏–∂–∞–π—à–µ–º—É –∫–ª–∞—Å—Ç–µ—Ä—É. –ü–æ—Å–ª–µ —ç—Ç–æ–≥–æ —Ü–µ–Ω—Ç—Ä–æ–∏–¥—ã –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è. –î–∞–ª–µ–µ –≤–µ—Å—å –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –ø–æ–∫–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –ø—Ä–µ–∫—Ä–∞—Ç—è—Ç—Å—è.

–ö–æ–Ω–µ—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–∞–∫–æ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞ –º–æ–≥—É—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è –Ω–∞ –±–æ–ª—å—à–∏—Ö –≤—ã–±–æ—Ä–∫–∞—Ö –ø–æ—Å–∫–æ–ª—å–∫—É –æ–Ω–∏ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω—ã—Ö —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤, –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º. –ü–æ—ç—Ç–æ–º—É –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é –º–µ—Ç–æ–¥–æ–º K-Means –≤—ã–ø–æ–ª–Ω—è—é—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑, –∞ –∑–∞—Ç–µ–º –≤—ã–±–∏—Ä–∞—é—Ç –Ω–∞–∏–ª—É—á—à—É—é, –∏—Å–ø–æ–ª—å–∑—É—è —Ç–∞–∫—É—é —Ñ–æ—Ä–º—É–ª—É:

![](./images/k-means.png)

–ù–∞–∏–ª—É—á—à–µ–π —è–≤–ª—è–µ—Ç—Å—è —Ç–∞, —É –∫–æ—Ç–æ—Ä–æ–π `V` –º–µ–Ω—å—à–µ.

#### –í–∞—Ä–∏–∞—Ü–∏–∏ –º–µ—Ç–æ–¥–∞

- **K-Means++** –≤—ã–±–∏—Ä–∞–µ—Ç —Ü–µ–Ω—Ç—Ä–æ–∏–¥—ã –Ω–µ —Å–æ–≤—Å–µ–º —Å–ª—É—á–∞–π–Ω–æ, –∞ —Å—Ç–∞—Ä–∞—è—Å—å —á—Ç–æ–±—ã –æ–Ω–∏ –Ω–µ –æ–∫–∞–∑–∞–ª–∏—Å—å —Ä—è–¥–æ–º.
- **K-Medians** –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ–¥–∏–∞–Ω—É –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è —Ü–µ–Ω—Ç—Ä–æ–∏–¥–∞
- **K-Medoids** —Ç–æ–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ–¥–∏–∞–Ω—É –¥–ª—è –Ω–∞—Ö–æ–∂–¥–µ–Ω–∏—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç —Ü–µ–Ω—Ç—Ä–æ–∏–¥–∞, –∞ –¥–∞–ª–µ–µ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Ü–µ–Ω—Ç—Ä–æ–∏–¥–∞ –Ω–µ –±–µ—Ä–µ—Ç –±–ª–∏–∂–∞–π—à–∏–π –∫ –Ω–µ–π —ç–ª–µ–º–µ–Ω—Ç
- **Fuzzy C-Means** –æ—Ç–Ω–æ—Å–∏—Ç —ç–ª–µ–º–µ–Ω—Ç—ã –∫ –∫–ª–∞—Å—Ç–µ—Ä–∞–º —Å —Ä–∞–∑–Ω–æ–π –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é (–æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ —ç–ª–µ–º–µ–Ω—Ç –º–æ–∂–µ—Ç –±—ã—Ç—å –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö)

#### –ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏ –º–µ—Ç–æ–¥–∞

- –ù—É–∂–Ω–æ –∑–∞—Ä–∞–Ω–µ–µ –∑–Ω–∞—Ç—å –∫–æ–ª-–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- –ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –∫ –≤—ã–±—Ä–æ—Å–∞–º
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–∏–ª—å–Ω–æ –∑–∞–≤–∏—Å—è—Ç –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Å–ª—É—á–∞–π–Ω–æ —Ü–µ–Ω—Ç—Ä–æ–∏–¥–æ–≤
- –ü–ª–æ—Ö–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏ –≤—ã—Ç—è–Ω—É—Ç–æ–π –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ñ–æ—Ä–º—ã

![](./images/dst3-ml4-2_18.png)

#### –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ `k`

##### –ú–µ—Ç–æ–¥ –ª–æ–∫—Ç—è (elbow plot)

–ß—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å `k` —ç—Ç–∏–º –º–µ—Ç–æ–¥–æ–º –Ω—É–∂–Ω–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª–µ–π –∏ –¥–ª—è –∫–∞–∂–¥–æ–π –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –µ–µ –∏–Ω–µ—Ä—Ü–∏—é –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ. **–ò–Ω–µ—Ä—Ü–∏—è** ‚Äî —ç—Ç–æ —Å—É–º–º–∞ –∫–≤–∞–¥—Ä–∞—Ç–æ–≤ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –¥–æ –µ–≥–æ —Ü–µ–Ω—Ç—Ä–æ–∏–¥–∞.

![](./images/dst3-ml4-2_19.png)

–û–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª-–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –±—É–¥–µ—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞ —Å–≥–∏–±–µ –ª–æ–∫—Ç—è.

##### –ú–µ—Ç–æ–¥ —Å–∏–ª—É—ç—Ç–∞ (average silhouette method)

–ú–µ—Ç–æ–¥ –ª–æ–∫—Ç—è –Ω–µ –≤—Å–µ–≥–¥–∞ –º–æ–∂–µ—Ç –¥–∞—Ç—å —Ç–æ—á–Ω—ã–π –æ—Ç–≤–µ—Ç, –ø–æ—Å–∫–æ–ª—å–∫—É –∏–∑–≥–∏–± –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–ª–∞–≤–Ω—ã–º. –ì—Ä–∞—Ñ–∏–∫ —Å–∏–ª—É—ç—Ç–∞ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ª–µ–≥—á–µ, —Ç–∞–∫ –∫–∞–∫ –æ–Ω –∏–º–µ–µ—Ç –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –ø–∏–∫.

![](./images/dst3-ml4-2_34.png)

–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–∏–ª—É—ç—Ç–∞ –≤–∞—Ä—å–∏—Ä—É–µ—Ç—Å—è –æ—Ç `-1` –¥–æ `+1` –∏ –ø–æ–∫–∞–∑—ã–≤–µ—Ç –Ω–∞—Å–∫–æ–ª—å–∫–æ –∫–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ—Ö–æ–∂ –Ω–∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–≤–æ–µ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞. –ï—Å–ª–∏ –ö–° —Ä–∞–≤–µ–Ω `1`, —Ç–æ –∑–Ω–∞—á–∏—Ç –∫–ª–∞—Å—Ç–µ—Ä—ã —Ö–æ—Ä–æ—à–æ –æ—Ç–¥–µ–ª–µ–Ω—ã –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞ –∏ –∏–º–µ—é—Ç –≤—ã—Å–æ–∫—É—é –ø–ª–æ—Ç–Ω–æ—Å—Ç—å.

–ö–° —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ —Å—Ä–µ–¥–Ω–µ–µ –∞—Ä–∏—Ñ–º–µ—Ç–∏—á–µ—Å–∫–æ–µ –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞ –ö–° —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ:

![](./images/silhouette.png)

### –ú–µ—Ç—Ä–∏–∫–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏ –º—ã –º–æ–∂–µ–º –ø–æ–ª—É—á–∏—Ç—å –ª–∏—à–Ω–∏–µ –∏/–∏–ª–∏ –Ω–µ–æ–¥–Ω–æ—Ä–æ–¥–Ω—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã.

![](./images/dst3-ml4-2_25.png)

–ï—Å–ª–∏ –º—ã –∏–º–µ–µ–º —á–∞—Å—Ç–∏—á–Ω–æ —Ä–∞–∑–º–µ—á–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, —Ç–æ —Å–º–æ–∂–µ–º –æ—Ü–µ–Ω–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏ —Å –ø–æ–º–æ—â—å—é —á–µ—Ç—ã—Ä–µ—Ö –º–µ—Ç—Ä–∏–∫.

1. Homogenity score
2. Completeness score
3. V-measure
4. Rand index

#### –û–¥–Ω–æ—Ä–æ–¥–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (homogenity score)

–ò–∑–º–µ–Ω—è–µ—Ç—Å—è –æ—Ç `0` (–∫–ª–∞—Å—Ç–µ—Ä—ã –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –Ω–µ–æ–¥–Ω–æ—Ä–æ–¥–Ω—ã) –¥–æ `1` (–∫–ª–∞—Å—Ç–µ—Ä—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–¥–Ω–æ—Ä–æ–¥–Ω—ã).

![](./images/dst3-ml4-2_26.png)

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from sklearn.metrics.cluster import homogeneity_score

lbls = [0, 0, 1, 1]
pred = [1, 1, 0, 0]
score = homogeneity_score(labels_true=lbls, labels_pred=pred)
```

#### –ü–æ–ª–Ω–æ—Ç–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ (completeness score)

–ò–∑–º–µ–Ω—è–µ—Ç—Å—è –æ—Ç `0` –¥–æ `1`. –ë—É–¥–µ—Ç —É–º–µ–Ω—å—à–∞—Ç—å—Å—è, –µ—Å–ª–∏ –æ–¥–Ω–æ—Ä–æ–¥–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–æ–±—Ä–∞–Ω—ã –Ω–µ –≤ –æ–¥–Ω–æ–º, –∞ –≤ –¥–≤—É—Ö –∏ –±–æ–ª–µ–µ –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö. (–ù–æ –±—É–¥–µ—Ç —Ä–∞–≤–Ω–∞ `1` –µ—Å–ª–∏ –∏ –∫–æ—à–∫–∏, –∏ —Å–æ–±–∞–∫–∏ –æ–∫–∞–∂—É—Ç—Å—è –≤ –æ–¥–Ω–æ–º –∫–ª–∞—Å—Ç–µ—Ä–µ.)

![](./images/dst3-ml4-2_28.png)

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from sklearn.metrics.cluster import completeness_score

lbls = [0, 0, 1, 1]
pred = [1, 1, 0, 0]
score = completeness_score(labels_true=lbls, labels_pred=pred)
```

#### V-–º–µ—Ä–∞ (V-measure)

–ò–∑–º–µ–Ω—è–µ—Ç—Å—è –æ—Ç `0` –¥–æ `1`. –≠—Ç–∞ –º–µ—Ç—Ä–∏–∫–∞ –∫–æ–º–±–∏–Ω–∏—Ä—É–µ—Ç –¥–≤–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–µ. –û–Ω–∞ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ.

![](./images/v-measure.png)

–° –ø–æ–º–æ—â—å—é `Œ≤` –º–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –≤–∞–∂–Ω–æ—Å—Ç—å—é —Å–æ—Å—Ç–∞–≤–ª—è—é—â–∏—Ö –µ–µ –º–µ—Ç—Ä–∏–∫: –µ—Å–ª–∏ `Œ≤ > 1`, —Ç–æ –±–æ–ª–µ–µ –≤–∞–∂–Ω–æ–π –±—É–¥–µ—Ç –ø–æ–ª–Ω–æ—Ç–∞, –∞ –µ—Å–ª–∏ `Œ≤ < 1`, —Ç–æ –æ–¥–Ω–æ—Ä–æ–¥–Ω–æ—Å—Ç—å.

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from sklearn.metrics.cluster import v_measure_score

lbls = [0, 0, 1, 1]
pred = [1, 1, 0, 0]
beta = 1.0
score = v_measure_score(labels_true=lbls, labels_pred=pred, beta=beta)
```

#### –ò–Ω–¥–µ–∫—Å –†—ç–Ω–¥–∞ (Rand index)

–ò–∑–º–µ–Ω—è–µ—Ç—Å—è –æ—Ç `0` –¥–æ `1`. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ —Å–≤–æ–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö –∫ –æ–±—â–µ–º—É –∫–æ–ª-–≤—É —ç–ª–µ–º–µ–Ω—Ç–æ–≤.

![](./images/dst3-ml4-2_30.png)

–í –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ –∏–Ω–¥–µ–∫—Å –±—É–¥–µ—Ç —Ä–∞–≤–µ–Ω `5/7`

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from sklearn.metrics.cluster import rand_score

lbls = [0, 0, 1, 1]
pred = [1, 1, 0, 0]
score = rand_score(labels_true=lbls, labels_pred=pred)
```

### Hierarchical clustering

**–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è** ‚Äî —ç—Ç–æ —Å–æ–∑–¥–∞–Ω–∏–µ –¥—Ä–µ–≤–æ–≤–∏–¥–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫–ª–∞—Å—Ç–µ—Ä–æ–≤. –í —Ç–∞–∫–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∫–ª–∞—Å—Ç–µ—Ä –º–æ–∂–µ—Ç –±—ã—Ç—å –∫–æ–Ω–µ—á–Ω—ã–º –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –æ–¥–Ω–∏ —Ç–æ–ª—å–∫–æ —ç–ª–µ–º–µ–Ω—Ç—ã, –∏–ª–∏ –∂–µ –æ–Ω –º–æ–∂–µ—Ç –±—ã—Ç—å –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã–º, –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –¥—Ä—É–≥–∏–µ –∫–ª—Å—Ç–µ—Ä—ã.

![](./images/dst3-ml4-3_1.png)

#### –ú–µ—Ç–æ–¥—ã —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

**–î–∏–≤–∏–∑–∏–æ–Ω–Ω—ã–π** (divisive) ‚Äî –æ—Ç –æ–±—â–µ–≥–æ –∫ —á–∞—Å—Ç–Ω–æ–º—É ‚Äî –∫–ª–∞—Å—Ç–µ—Ä—ã –æ–±—Ä–∞–∑—É—é—Ç—Å—è –¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ –±–æ–ª–µ–µ –º–µ–ª–∫–∏–µ.

![](./images/dst3-ml4-3_7.png)

**–ê–≥–ª–æ–º–µ—Ä–∞—Ç–∏–≤–Ω—ã–π** (agglomerative) ‚Äî –æ—Ç —á–∞—Å—Ç–Ω–æ–≥–æ –∫ –æ–±—â–µ–º—É ‚Äî –∫–ª–∞—Å—Ç–µ—Ä—ã –æ–±—Ä–∞–∑—É—é—Ç—Å—è —Å –ø–æ–º–æ—â—å—é –æ–±—ä–µ–¥–∏–Ω–µ–Ω–∏—è –≤ –±–æ–ª–µ–µ –∫—Ä—É–ø–Ω—ã–µ.

![](./images/dst3-ml4-3_6.png)

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from sklearn.cluster import AgglomerativeClustering

ag_cl = AgglomerativeClustering(n_clusters=4, linkage='ward')
ag_cl.fit(X)

print(ag_cl.labels_)
```

#### –î–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º–∞

‚Äî —ç—Ç–æ –≤–∏–¥ –¥–∏–∞–≥—Ä–∞–º–º –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –≤ —Ç–æ–º —á–∏—Å–ª–µ –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–æ–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏.

–ù–∞ –¥–µ–Ω—Ä–¥–æ–≥—Ä–∞–º–º–µ –º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å:

- *–∫–æ—Ä–µ–Ω—å*
- *–≤–Ω—É—Ä—Ç–µ–Ω–Ω–∏–µ –≤–µ—Ç–∫–∏* (—Å *–≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–º–∏ –Ω–æ–¥–∞–º–∏*)
- *—Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã–µ –≤–µ—Ç–∫–∏* (—Å *–ª–∏—Å—Ç—å—è–º–∏*)

![](./images/dst3-ml4-3_2.png)

–£ –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º—ã –µ—Å—Ç—å –∏–Ω—Ç–µ—Ä–µ—Å–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å: —á–µ–º –±–æ–ª—å—à–µ —Å—Ö–æ–∂–µ—Å—Ç—å –¥–≤—É—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤, —Ç–µ–º –∫–æ—Ä–æ—á–µ –æ—Ç—Ö–æ–¥—è—â–∏–µ –æ—Ç –Ω–∏—Ö —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã–µ –≤–µ—Ç–∫–∏.

![](./images/dst3-ml4-3_3.png)

–ê–Ω–∞–ª–∏–∑ –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- –ø–æ–Ω—è—Ç—å –∫–∞–∫ –æ–±—ä–µ–¥–∏–Ω—è–ª–∏—Å—å (–∏–ª–∏ –¥–µ–ª–∏–ª–∏—Å—å) –∫–ª–∞—Å—Ç–µ—Ä—ã
- –Ω–∞—Å–∫–æ–ª—å–∫–æ –ø–æ—Ö–æ–∂–∏ —Å–æ—Å–µ–¥–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä—ã (–∫–æ–Ω–µ—á–Ω—ã–µ)
- –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª-–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

–¢–∞–∫–∂–µ –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º–∞ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å, —Å–∫–æ–ª—å–∫–æ –±—É–¥–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, –µ—Å–ª–∏ –º–µ–∂–¥—É –Ω–∏–º–∏ –±—É–¥–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ `y`. –î–ª—è —ç—Ç–æ–≥–æ –Ω—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Å—Ç–∏ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω—É—é –ª–∏–Ω–∏—é –Ω–∞ –≤—ã—Å–æ—Ç–µ `y`: —Å–∫–æ–ª—å–∫–æ –≤–µ—Ç–æ–∫ –æ–Ω–∞ –ø–µ—Ä–µ—Å–µ–∫–ª–∞, —Å—Ç–æ–ª—å–∫–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –∏ –±—É–¥–µ—Ç.

![](./images/dendrogram-crossed.png)

#### –ú–µ—Ç—Ä–∏—Ü–∞ —Å—Ö–æ–¥—Å—Ç–≤

–ü–æ—Å–ª–µ —Ç–æ–≥–æ –∫–∞–∫ –∫–ª–∞—Å—Ç–µ—Ä—ã —Å–æ–∑–¥–∞–Ω—ã, –º–µ–∂–¥—É –Ω–∏–º–∏ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –∏ –ø–æ–º–µ—â–∞—é—Ç –∏—Ö –≤ **–º–∞—Ç—Ä–∏—Ü—É —Å—Ö–æ–¥—Å—Ç–≤**. –¢–∞–∫–∞—è –º–∞—Ç—Ä–∏—Ü–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –¥–∞–ª—å–Ω–µ–π—à–µ–º –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –¥–µ–Ω—Ä–¥—Ä–æ–≥—Ä–∞–º–º—ã. 

![](./images/dst3-ml4-3_8.png)

–í –Ω–µ–π –ø–æ –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª–∏ –∏ –ø–æ –≤–µ—Ä—Ç–∏–∫–∞–ª–∏ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω—ã –≤—Å–µ –∫–ª–∞—Å—Ç–µ—Ä—ã (–æ—Ç `1` –¥–æ `n`), –∞ –Ω–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è—Ö ‚Äî —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –Ω–∏–º–∏. –ù–∞–ø—Ä–∏–º–µ—Ä –≤ `i`-–æ–π —Å—Ç—Ä–æ–∫–µ –∏ `j`-–æ–º —Å—Ç–æ–ª–±—Ü–µ –±—É–¥–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏ `i` –∏ `j`. –ê –≤ –¥–∏–∞–≥–æ–Ω–∞–ª–∏ —Ç–∞–∫–æ–π –º–∞—Ç—Ä–∏—Ü—ã –±—É–¥—É—Ç –µ–¥–∏–Ω–∏—Ü—ã.

#### –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏

–î–ª—è –∏—Ö —Ä–∞—Å—Å—á–µ—Ç–∞ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Ä–∞–∑–ª–∏—á–Ω—ã–µ –º–µ—Ç–æ–¥—ã.

- single linkage
- comlete linkage
- arithmetic mean
- centroid

**–ú–µ—Ç–æ–¥ –æ–¥–∏–Ω–æ—á–Ω–æ–π —Å–≤—è–∑–∏** (single linkage) –±–µ—Ä–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –±–ª–∏–∂–∞–π—à–∏–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –≤ –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö.

**–ú–µ—Ç–æ–¥ –ø–æ–ª–Ω–æ–π —Å–≤—è–∑–∏** (complete linkage) –±–µ—Ä–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–¥–∂—É —Å–∞–º—ã–º–∏ –æ—Ç–¥–∞–ª–µ–Ω–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏.

**–ú–µ—Ç–æ–¥ —Å—Ä–µ–¥–Ω–µ–π —Å–≤—è–∑–∏** (arithmetic mean) –±–µ—Ä–µ—Ç —Å—Ä–µ–¥–Ω–µ–µ –≤—Å–µ—Ö —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–π –º–µ–∂–¥—É –≤—Å–µ–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.

**–¶–µ–Ω—Ç—Ä–æ–∏–¥–Ω—ã–π –º–µ—Ç–æ–¥** (centroid) –±–µ—Ä–µ—Ç —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É —Ü–µ–Ω—Ç—Ä–æ–∏–¥–∞–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.

–í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∏—Ç—É–∞—Ü–∏–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç —Ä–∞–∑–Ω—ã–µ –º–µ—Ç–æ–¥—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –ø—Ä–æ—è–≤–ª—è—é—Ç —Å–µ–±—è —Å —Ä–∞–∑–Ω–æ–π —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å—é.

![](./images/dst3-ml4-3_13.png)

#### Pros & cons

üëç –î–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–∑–Ω–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª-–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

üëç –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –Ω–∞ –Ω–µ–±–æ–ª—å—à–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ

üëé –ï—Å–ª–∏ –¥–∞–Ω–Ω—ã—Ö –º–Ω–æ–≥–æ, —Ç–æ –¥–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º—É —Å–ª–æ–∂–Ω–æ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä–æ–≤–∞—Ç—å

üëé –ú–æ–∂–µ—Ç –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ —Ä–∞–∑–¥–µ–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä—ã

### Gaussian Mixture Model

K-means –∞–ª–≥–æ—Ä–∏—Ç–º –ø–ª–æ—Ö–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –∫–ª–∞—Ç–µ—Ä–∞–º–∏, –∏–º–µ—é—â–∏–º–∏ –≤—ã—Ç—è–Ω—É—Ç—É—é —Ñ–æ—Ä–º—É. **–ú–æ–¥–µ–ª—å –≥–∞—É—Å—Å–æ–≤–æ–π —Å–º–µ—Å–∏** —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å —ç—Ç–æ–π –∑–∞–¥–∞—á–µ–π –ª—É—á—à–µ. (K-means —è–≤–ª—è–µ—Ç—Å—è —á–∞—Å—Ç–Ω—ã–º —Å–ª—É—á–∞–µ–º GMM.)

![](./images/dst3-ml4-3_18.gif)

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from sklearn.mixture import GaussianMixture

gm_clustering = GaussianMixture(n_components=3, random_state=42)
gm_clustering.fit(X)

gm_clustering.predict(X)
```

##### Pros & cons

–ü–ª—é—Å—ã

- –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö —ç–ª–ª–∏–ø—Ç–∏—á–µ—Å–∫–æ–π —Ñ–æ—Ä–º—ã \
![](./images/dst3-ml4-3_23.png)
- –°–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –∑–∞–¥–∞—á–µ–π –∫–æ–≥–¥–∞ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –º–µ–∂–¥—É –¥–≤—É–º—è –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏ \
![](./images/dst3-ml4-3_24.png)

–ú–∏–Ω—É—Å—ã

- –ù—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ–ª-–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- –ó–∞–≤–∏—Å–∏—Ç –æ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- –ú–æ–∂–µ—Ç –¥–æ–ª–≥–æ —Å—Ö–æ–¥–∏—Ç—å—Å—è

### Spectral clustering

**–°–ø–µ–∫—Ç—Ä–∞–ª—å–Ω–∞—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è** –∏–º–µ–µ—Ç –Ω–∞ –≤–æ–æ—Ä—É–∂–µ–Ω–∏–∏ –∞–ª–≥–æ—Ä–∏—Ç–º, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–Ω–∏–∂–∞–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö. –û–Ω —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ —á–µ—Ç—ã—Ä–µ—Ö —à–∞–≥–æ–≤:

1. –°–æ–∑–¥–∞–µ—Ç—Å—è –≥—Ä–∞—Ñ. –ï–≥–æ –≤–µ—Ä—à–∏–Ω—ã ‚Äî —ç–ª–µ–º–µ–Ω—Ç—ã, –∞ —Ä–µ–±—Ä–∞ ‚Äî —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –Ω–∏–º–∏. –î–∞–Ω–Ω—ã–µ –∑–∞–Ω–æ—Å—è—Ç—Å—è –≤ –º–∞—Ç—Ä–∏—Ü—É —Å—Ö–æ–¥—Å—Ç–≤.\
![](./images/dst3-ml4-3_25.png)
1. –° –º–∞—Ç—Ä–∏—Ü–µ–π —Å–æ–≤–µ—Ä—à–∞—é—Ç—Å—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è.
1. –ú–∞—Ç—Ä–∏—Ü–∞ —É–ø—Ä–æ—â–∞–µ—Ç—Å—è (—Ä–µ–¥—É—Ü–∏—Ä—É–µ—Ç—Å—è –≤ –≤–µ–∫—Ç–æ—Ä).\
![](./images/dst3-ml4-3_27.png)
1. –ü–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º —ç–ª–µ–º–µ–Ω—Ç—ã –¥–µ–ª—è—Ç—Å—è –Ω–∞ –¥–≤–∞ –∫–ª–∞—Å—Ç–µ—Ä–∞.\
![](./images/dst3-ml4-3_28.png)

–í –ø–æ–ª—É—á–∏–≤—à–∏—Ö—Å—è –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è.

–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –æ—Ç —à—É–º–∞.

![](./images/spectral_clustering.png)

#### Pros & cons

–ü–ª—é—Å—ã

- –†–∞–±–æ—Ç–∞–µ—Ç —Å –±–æ–ª—å—à–∏–º –∫–æ–ª-–≤–æ–º –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Ç–∞–∫ –∫–∞–∫ —Ä–µ–¥—É—Ü–∏—Ä—É–µ—Ç —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç—å
- –ú–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ä–∞–∑—Ä—è–∂–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –•–æ—Ä–æ—à–æ —Å–µ–±—è –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ—á—Ç–∏ –Ω–∞ –ª—é–±—ã—Ö —Ñ–æ—Ä–º–∞—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤\
![](./images/dst3-ml4-3_32.png)

–ú–∏–Ω—É—Å—ã

- –ù—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å –∫–æ–ª-–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- –ö–ª–∞—Å—Ç–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω—ã (—Ç–∞–∫–∏–µ –≤ –∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–ª-–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–µ —Å–∏–ª—å–Ω–æ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è)

### DBSCAN

**–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏** –∏–ª–∏ DBSCAN (*densiti-based spatial clustering of applications with noise*) —Ö–æ—Ä–æ—à–æ —Å–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –≤—ã–±—Ä–æ—Å–∞–º–∏, –∞ —Ç–∞–∫–∂–µ —Å–∞–º –Ω–∞—Ö–æ–¥–∏—Ç –≤—Å–µ –∫–ª–∞—Å—Ç–µ—Ä—ã ‚Äî¬†–∏—Ö –∫–æ–ª-–≤–æ –Ω–µ –Ω—É–∂–Ω–æ –∑–∞–¥–∞–≤–∞—Ç—å‚ùóÔ∏è ‚Äî –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ –∏–º–µ—é—Ç –ø—Ä–∏—á—É–¥–ª–∏–≤—É—é —Ñ–æ—Ä–º—É.

#### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

| # | –û–ø–∏—Å–∞–Ω–∏–µ —ç—Ç–∞–ø–∞ | –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è |
| - | - | - |
| 1 | –ù–∞—Ö–æ–¥—è—Ç –≤—Å–µ *—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏*, —Ç.–µ. —Ç–∞–∫–∏–µ, –≤–æ–∫—Ä—É–≥ –∫–æ—Ç–æ—Ä—ã—Ö –∏–º–µ—é—Ç—Å—è —Ç—Ä–∏ –∏ –±–æ–ª–µ–µ —Ç–æ—á–µ–∫ (—á–∏—Å–ª–æ –∑–∞–¥–∞–µ—Ç—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö). –¢–æ—á–∫–∏ –±–µ–∑ —Å–æ—Å–µ–¥–µ–π ‚Äî –≤—ã–±—Ä–æ—Å—ã ‚Äî –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è. | ![](./images/dbscan-1.png) |
| 2 | –í—ã–±–∏—Ä–∞—é—Ç –æ–¥–Ω—É –∏–∑ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫ –∏ –æ—Ç–Ω–æ—Å—è—Ç –µ–µ –∫ –ø–µ—Ä–≤–æ–º—É –∫–ª–∞—Å—Ç–µ—Ä—É. –ó–∞—Ç–µ–º –∫ —ç—Ç–æ–º—É –∫–ª–∞—Å—Ç–µ—Ä—É –æ—Ç–Ω–æ—Å—è—Ç —Å–æ—Å–µ–¥–Ω–∏–µ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏, –∏ –¥–∞–ª–µ–µ –ø–æ —Ü–µ–ø–æ—á–∫–µ. | ![](./images/dbscan-2.png) |
| 3 | –î–∞–ª–µ–µ –Ω–∞—Ö–æ–¥—è—Ç –≤—Å–µ –Ω–µ—Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–µ —Ç–æ—á–∫–∏ –≤ —Ä–∞–¥–∏—É—Å–µ `r` –æ—Ç —Ç–æ—á–µ–∫ –∫–ª–∞—Å—Ç–µ—Ä–∞. –†–∞–¥–∏—É—Å —Ç–∞–∫–∂–µ –∑–∞–¥–∞–µ—Ç—Å—è –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö. | ![](./images/dbscan-3.png) |
| 4 | –ü—Ä–æ—Ü–µ—Å—Å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫, –Ω–µ –≤–æ—à–µ–¥—à–∏—Ö –≤ –ø–µ—Ä–≤—ã–π –∫–ª–∞—Å—Ç–µ—Ä. –ò —Ç–∞–∫ –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –Ω–µ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã—Ö —Ç–æ—á–µ–∫ –±–µ–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞. | ![](./images/dbscan-4.png) |

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from sklearn.cluster import DBSCAN

clustering = DBSCAN(
    min_samples=3, # –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª-–≤–æ —Å–æ—Å–µ–¥–µ–π —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π —Ç–æ—á–∫–∏
    eps=3, # –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–¥–∏—É—Å –¥–æ —Å–æ—Å–µ–¥–Ω–µ–π —Ç–æ—á–∫–∏
)
clustering.fit(X)

print(clustering.labels_)
```

#### Pros & cons

–ü–ª—é—Å—ã

- –ù–µ –Ω—É–∂–Ω–æ –∑–∞–¥–∞–≤–∞—Ç—å –∫–æ–ª-–≤–æ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
- –°–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å –≤—ã–±—Ä–æ—Å–∞–º–∏
- –ù–µ–æ–±—ã—á–Ω–∞—è —Ñ–æ—Ä–º–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ ‚Äî –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞

–ú–∏–Ω—É—Å—ã

- –ï—Å–ª–∏ —Ç–æ—á–∫–∞ —Ä–∞–≤–Ω–æ—É–¥–∞–ª–µ–Ω–∞ –æ—Ç –¥–≤—É—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, –æ–Ω–∞ –±—É–¥–µ—Ç –æ—Ç–Ω–µ—Å–µ–Ω–∞ –∫ –ø–µ—Ä–≤–æ–º—É
- –ü–ª–æ—Ç–Ω–æ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç–æ–≤ *–≤–æ –≤—Å–µ—Ö –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö* –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π
- –ò–Ω–æ–≥–¥–∞ —Ç—Ä—É–¥–Ω–æ –ø–æ–¥–æ–±—Ä–∞—Ç—å `eps`

### –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

![](./images/dst3-ml4-4_1.png)

#### Convex hull

–≠—Ç–æ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤—ã–ø—É–∫–ª–æ–≥–æ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –µ–ª–µ–º–µ–Ω—Ç–æ–≤ –∫–ª–∞—Å—Ç–µ—Ä–∞.

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from scipy.spatial import ConvexHull

def get_convex_hull_points(points):
    hull = ConvexHull(points)

    return (
        [points[x][0] for x in hull.vertices],
        [points[x][1] for x in hull.vertices],
    )

# points = np.array([[1,1], [1,2], [2,4], [3,0]])
hull_x, hull_y = get_convex_hull_points(points)
plt.fill(hull_x, hull_y, color='#FF0000', alpha=0.2);
```

#### –î–µ–Ω–¥—Ä–æ–≥—Ä–∞–º–º–∞

–î–ª—è –µ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ [dendrogram](https://docs.scipy.org/doc/scipy/reference/generated/scipy.cluster.hierarchy.dendrogram.html) –∏ [linkage](https://docs.scipy.org/doc/scipy/reference/generated/scipy.cluster.hierarchy.linkage.html)

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
def draw_dendrogram(data, n_clusters, method):
    agglomerative_clustering = AgglomerativeClustering(n_clusters, linkage=method)
    predictions_ag_model = agglomerative_clustering.fit_predict(data)

    linked = linkage(data, method)

    _fig, ax = figax('dendrogram')

    dendrogram(
        ax=ax,
        Z=linked,
        orientation='top',
        labels=predictions_ag_model,
        distance_sort='ascending'
    )
```

#### Clustergram

–û–¥–Ω–∞ –¥–∏–∞–≥—Ä–∞–º–º–∞ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–Ω—è—Ç—å, –∫–∞–∫ *–≤—ã–±—Ä–∞–Ω–Ω—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º* –ø–æ–¥–µ–ª–∏—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞ –¥–≤–∞, —Ç—Ä–∏, –∏ —Ç.–¥. –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.

![](./images/dst3-ml4-4_16.png)

–ß–µ–º –∂–∏—Ä–Ω–µ–µ —Ç–æ—á–∫–∞, —Ç–µ–º –±–æ–ª—å—à–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤—Ö–æ–¥–∏—Ç –≤ –∫–ª–∞—Å—Ç–µ—Ä. –ñ–∏—Ä–Ω–æ—Å—Ç—å –ø–æ–ª–æ—Å –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ü–µ–Ω–∏—Ç—å –≤–∫–ª–∞–¥ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤.

–ù–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç—Ä–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞:

- –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫—É—é –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é
- k-means
- GMM

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ API –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –Ω–∞ [Github](https://github.com/martinfleis/clustergram).

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
# ! pip install clustergram

from clustergram import Clustergram

cgram = Clustergram(range(1, 6), method='kmeans')

cgram.fit(X)

cgram.plot()
```

#### 3D-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è Matplotlib

–ü–æ–∑–≤–æ–ª—è–µ—Ç –±—ã—Å—Ç—Ä–æ –æ—Ü–µ–Ω–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏. –†–∞–±–æ—Ç–∞–µ—Ç —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏, –ø–æ—ç—Ç–æ–º—É –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–æ–¥–µ–ª–∏.

![](./images/axes3d.png)

–ú–∏–Ω—É—Å —Ç–∞–∫–æ–π –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≤ —Ç–æ–º, —á—Ç–æ –∫–∞—Ä—Ç–∏–Ω–∫–∞ —Å—Ç–∞—Ç–∏—á–Ω–∞.

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from mpl_toolkits.mplot3d import Axes3D

fig, _ax = figax('Axes3D')
ax = Axes3D(fig)
fig.add_axes(ax)

data_x = X['latitude'].to_list()
data_y = X['longitude'].to_list()
data_z = X['price'].to_list()
ax.scatter(data_x, data_y, data_z, c=predictions)

ax.azim = 10
ax.elev = 20

ax.set_xlabel('latitude')
ax.set_ylabel('longitude')
ax.set_zlabel('price')
```

#### 3D –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è Plotly

–û–±–ª–∞–¥–∞–µ—Ç –ø–ª—é—Å–∞–º–∏ 3D –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ Matplotlib, –Ω–æ –ø—Ä–∏ —ç—Ç–æ–º –ª–∏—à–µ–Ω–∞ –µ–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∞.

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
import plotly
import plotly.express as px

fig = px.scatter_3d(
    data_frame=df, 
    x = 'longitude', 
    y = 'latitude', 
    z = 'price', 
    color='clusters', 
    width=1000,
    height=700
)

fig.show()
```

## Dimension reduction

**–ü–æ–Ω–∏–∂–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏** —ç—Ç–æ –∑–∞–¥–∞—á–∞, –∫–æ—Ç–æ—Ä–∞—è —É–º–µ–Ω—å—à–∞–µ—Ç –∫–æ–ª-–≤–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –æ–ø–∏—Å—ã–≤–∞—é—â–∏—Ö –æ–±—ä–µ–∫—Ç. –î–ª—è –¥–∞–Ω–Ω—ã—Ö —Å –±–æ–ª—å—à–∏–º –∫–æ–ª-–≤–æ–º –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –æ–Ω–∞ –º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –≤ –¥–≤—É—Ö —Å–ª—É—á–∞—è—Ö:

- —á—Ç–æ–±—ã –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
- —á—Ç–æ–±—ã –±—ã—Å—Ç—Ä–µ–µ –æ–±—É—á–∏—Ç—å –º–æ–¥–µ–ª—å

–í –ø—Ä–æ—Ü–µ—Å—Å–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞—á–∏ –ø–æ–Ω–∏–∂–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏ —Å–∞–º–∏ *–¥–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω—ã* –æ–¥–Ω–∏–º –∏–∑ –¥–≤—É—Ö —Å–ø–æ—Å–æ–±–æ–≤:

- –ª–∏–Ω–µ–π–Ω–æ
- –Ω–µ–ª–∏–Ω–µ–π–Ω–æ

### Principal Component Analysis (PCA)

**–ú–µ—Ç–æ–¥ –≥–ª–∞–≤–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç** —è–≤–ª—è–µ—Ç—Å—è –±–∞–∑–æ–≤—ã–º —Å–ø–æ—Å–æ–±–æ–º —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–Ω–æ—Å—Ç–∏. –ü—Ä–∏–Ω—Ü–∏–ø –µ–≥–æ —Ä–∞–±–æ—Ç—ã –∏–∑–ª–æ–∂–µ–Ω –≤ –∫—É—Ä—Å–µ —Å–ª–∏—à–∫–æ–º –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ. –ù–æ —è –ø–æ–Ω—è–ª, —á—Ç–æ —ç—Ç–æ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º *–ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –ª–∏–Ω–µ–π–Ω–æ*.

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from sklearn.decomposition import PCA

pca = PCA(
    n_components=2, # —Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å
    random_state=42)

X_pca = pca.fit_transform(X)
```

### t-SNE

–ê–ª–≥–æ—Ä–∏—Ç–º t-SNE (t-distributed Stochastic Neighbor Embedding) –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–µ–ª–∏–Ω–µ–π–Ω–æ. –ü—Ä–∏–Ω—Ü–∏–ø –µ–≥–æ —Ä–∞–±–æ—Ç—ã –¥–æ–ª–≥–æ –æ–±—ä—è—Å–Ω—è—Ç—å. –ü–æ —Å—É—Ç–∏ –æ–Ω –ø—ã—Ç–∞–µ—Ç—Å—è —Ä–∞–∑–º–µ—Å—Ç–∏—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞ –ø–ª–æ—Å–∫–æ—Å—Ç–∏, —Å–æ—Ö—Ä–∞–Ω–∏–≤ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è –º–µ–∂–¥—É –Ω–∏–º–∏.

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from sklearn.manifold import TSNE

tsne = TSNE(
    n_components=2, # —Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Ö–æ—Ç–∏–º –ø–æ–ª—É—á–∏—Ç—å
    perplexity=30, # –æ–∂–∏–¥–∞–µ–º–∞—è –ø–ª–æ—Ç–Ω–æ—Å—Ç—å –≤–æ–∫—Ä—É–≥ —Ç–æ—á–∫–∏, –æ–±—ã—á–Ω–æ –æ—Ç 5 –¥–æ 50.
    n_iter=500,
    random_state=42,
)

X_tsne = tsne.fit_transform(X)
```

## –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –ú–µ—Ç–æ–¥—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏

–†–∞–∑–ª–∏—á–∞—é—Ç *–¥–≤—É—Ö–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥* –∏ *—Ç—Ä–µ—Ö–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥*

![](./images/dst3-ml5-2_1.png)

–î–≤—É—Ö–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –ø–ª–æ—Ö —Ç–µ–º, —á—Ç–æ —Ç–µ—Å—Ç–æ–≤—ã–π –Ω–∞–±–æ—Ä –Ω–µ—è–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–µ–ª–∏. –¢–æ-–µ—Å—Ç—å –º–æ–¥–µ–ª—å –ø–æ–¥—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –ø–æ–¥ –Ω–µ–≥–æ.

![](./images/dst3-ml5-2_2.png)

–¶–µ–ª—å —Ç—Ä–µ—Ö–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ ‚Äî –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—É—é –≤—ã–±–æ—Ä–∫—É. 

**–í–∞–ª–∏–¥–∞—Ü–∏—è** ‚Äî —ç—Ç–æ –ø—Ä–æ–≤–µ—Ä–∫–∞ "–ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏" –º–æ–¥–µ–ª–∏.

### Hold-out

–≠—Ç–∏–º —Ç–µ—Ä–º–∏–Ω–æ–º –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ä–∞–∑–±–∏–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –¥–≤–µ (train + test) –∏–ª–∏ –Ω–∞ —Ç—Ä–∏ (train + validation + test) —á–∞—Å—Ç–∏. –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –ø—Ä–æ—Å—Ç–æ–π –∏ –æ—á–µ–Ω—å –ø–æ–ø—É–ª—è—Ä–Ω—ã–π.

![](./images/hold-out.png)

–ï–≥–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –≤ —Ç–æ–º, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ —Ä–∞–∑–±–∏–≤–∞—é—Ç—Å—è –Ω–∞ —á–∞—Å—Ç–∏ —Å–ª—É—á–∞–π–Ω—ã–º –æ–±—Ä–∞–∑–æ–º, –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —á–µ–≥–æ –≤ —Ç–µ—Å—Ç–æ–≤–æ–π –≤—ã–±–æ—Ä–∫–µ –º–æ–≥—É—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è –Ω–µ —Å–æ–≤—Å–µ–º —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from sklearn.model_selection import train_test_split

X_train, X_test, y_train, y_test = train_test_split(
    X,
    y,
    test_size=0.2,
    random_state=42,
    stratify=y,
)

# –µ—Å–ª–∏ –Ω—É–∂–Ω–∞ —Ç—Ä–µ—Ç—å—è –≤—ã–±–æ—Ä–∫–∞ (validation) —Ç–æ –º–µ—Ç–æ–¥ –∑–∞–ø—É—Å–∫–∞—é—Ç –µ—â–µ —Ä–∞–∑
```

### K-fold

–î–∞–Ω–Ω—ã–π –º–µ—Ç–æ–¥ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è —Ç–µ–º, —á—Ç–æ –¥–ª—è –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö. –î–ª—è —ç—Ç–æ–≥–æ –æ–Ω —Ä–∞–∑–±–∏–≤–∞–µ—Ç—Å—è –Ω–∞ `k` —á–∞—Å—Ç–µ–π (*folds*) –æ–¥–Ω–∞ —á–∞—Å—Ç—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–∏, –∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è. –ü—Ä–æ—Ü–µ—Å—Å –ø–æ–≤—Ç–æ—Ä—è–µ—Ç—Å—è `k` —Ä–∞–∑.

![](./images/k-fold.png)

–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–æ —Ç–∞–∫–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞ –≤ —Ç–æ–º, —á—Ç–æ –≤–∞–ª–∏–¥–∞—Ü–∏—è –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ–¥–µ–Ω–∞ –Ω–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö.

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from sklearn import model_selection

kf = model_selection.KFold(
    n_splits=5,
    shuffle=True, # default is False
    random_state=42,
)

for train_idx, valid_idx in kf.split(X, y):
    X_train, y_train = X.iloc[train_idx], y.iloc[train_idx]
    X_valid, y_valid = X.iloc[valid_idx], y.iloc[valid_idx]
```

–î—Ä—É–≥–æ–π –ø—Ä–∏–º–µ—Ä —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ `cross_validate`

```python
from sklearn import model_selection

# model = ...

kf = model_selection.KFold(n_splits=5)
 
cv_metrics = model_selection.cross_validate(
    estimator=model, # –º–æ–¥–µ–ª—å
    X=X,
    y=y,
    cv=kf,
    scoring='accuracy', # –∂–µ–ª–∞–µ–º–∞—è –º–µ—Ç—Ä–∏–∫–∞
    return_train_score=True,
)

display(cv_metrics)
```

### Leave-one-out

–≠—Ç–æ —á–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π k-fold —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º –∫–æ–ª-–≤–æ–º —Ñ–æ–ª–¥–æ–≤. –•–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –Ω–µ–±–æ–ª—å—à–∏—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤.

![](./images/dst3-ml5-2_10.png)

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from sklearn import model_selection

# model = ...

loo = model_selection.LeaveOneOut()
 
cv_metrics = model_selection.cross_validate(
    estimator=model, # –º–æ–¥–µ–ª—å
    X=X,
    y=y,
    cv=loo,
    scoring='accuracy', # –∂–µ–ª–∞–µ–º–∞—è –º–µ—Ç—Ä–∏–∫–∞
    return_train_score=True,
)

display(cv_metrics)
```

## –î–∏—Å–±–∞–ª–∞–Ω—Å –¥–∞—Ç–∞—Å–µ—Ç–∞

–í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –∑–∞–¥–∞—á–∞—Ö –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫ –≤ –æ–±—É—á–∞—é—â–µ–º –¥–∞—Ç–∞—Å–µ—Ç–µ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω –Ω–µ—Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ. –ù–∞–ø—Ä–∏–º–µ—Ä –¥–ª—è –∑–∞–¥–∞—á –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞ –≤ –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è—Ö –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ –¥–∞–Ω–Ω—ã—Ö (–±–æ–ª–µ–µ 99%) –±—É–¥—É—Ç –æ–ø–∏—Å—ã–≤–∞—Ç—å –æ–±—ã—á–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.

–ö–ª–∞—Å—Å –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–∞ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **–º–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω—ã–º** (majority), –∞ –∫–ª–∞—Å—Å –º–µ–Ω—å—à–∏–Ω—Å—Ç–≤–∞ ‚Äî **–º–∏–Ω–æ—Ä–∏—Ç–∞—Ä–Ω—ã–º** (minority).

–í —Ç–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –Ω—É–∂–Ω–æ:

- —Å–ª–µ–¥–∏—Ç—å —á—Ç–æ–±—ã —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫ –±—ã–ª —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω –æ–¥–∏–Ω–∞–∫–æ–≤–æ –≤ train –∏ test –≤—ã–±–æ—Ä–∫–∞—Ö
- –Ω–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–¥–µ–ª–∏ Decision tree –∏ Logistic regression, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∏ –∏–º–µ—é—Ç —Ç–µ–Ω–¥–µ–Ω—Ü–∏—é –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å –º–∏–Ω–æ—Ä–∏—Ç–∞—Ä–Ω—ã–π –∫–ª–∞—Å—Å
- –Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –º–µ—Ç—Ä–∏–∫–æ–π accuracy

### –°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–∞–∑–±–∏–µ–Ω–∏–µ

–ß—Ç–æ–±—ã —Ü–µ–ª–µ–≤–æ–π –ø—Ä–∏–∑–Ω–∞–∫ –∫–∞–∂–¥–æ–≥–æ –∏–∑ –∫–ª–∞—Å—Å–æ–≤ –±—ã–ª —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω –≤ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –ø—Ä–æ–ø–æ—Ä—Ü–∏—è—Ö –≤ train –∏ test –≤—ã–±–æ—Ä–∫–∞—Ö –Ω—É–∂–Ω–æ –≤ –º–µ—Ç–æ–¥–µ `train_test_split` –≤–∫–ª—é—á–∞—Ç—å —Ñ–ª–∞–≥ `stratify`. –ê –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏ `K-fold` –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª–∑–æ–≤–∞—Ç—å –µ–≥–æ –≤–µ—Ä—Å–∏—é [StratifiedKFold](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.StratifiedKFold.html)

### –í–∑–≤–µ—à–∏–≤–∞–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤

–°–º—ã—Å–ª –≤ —Ç–æ–º, —á—Ç–æ–±—ã –ø—Ä–∏–¥–∞—Ç—å –±–æ–ª—å—à–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–∏–Ω–æ—Ä–∏—Ç–∞—Ä–Ω–æ–º—É –∫–ª–∞—Å—Å—É. –í–µ—Å –º–∞–∂–æ—Ä–∏—Ç–∞—Ä–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è –∑–∞ `1`, –∞ –≤–µ—Å –º–∏–Ω–æ—Ä–∏—Ç–∞—Ä–Ω–æ–≥–æ —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ:

![](./images/weight_of_minority_class.png)

–î–∞–Ω–Ω—ã–µ –≤–µ—Å–∞ –±—É–¥—É—Ç –ø–æ—Å—á–∏—Ç–∞–Ω—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –µ—Å–ª–∏ —Å–æ–∑–¥–∞—Ç—å –º–æ–¥–µ–ª—å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º `class_weight='balanced'`

### –í—ã–±–æ—Ä –ø–æ—Ä–æ–≥–∞ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –∏ PR-–∫—Ä–∏–≤–∞—è

–ú–æ–¥–µ–ª–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç *–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å* –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ —ç–ª–µ–º–µ–Ω—Ç–∞ –∫ —Ç–æ–º—É –∏–ª–∏ –∏–Ω–æ–º—É –∫–ª–∞—Å—Å—É, —Ç–æ –µ—Å—Ç—å —á–∏—Å–ª–æ –æ—Ç `0` –¥–æ `1`. –û–±—ã—á–Ω–æ –ø–æ—Ä–æ–≥–æ–º —è–≤–ª—è–µ—Ç—Å—è —á–∏—Å–ª–æ `0.5`, –Ω–æ –µ–≥–æ –º–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å, –ø–æ–¥–≥–æ–Ω—è—è –ø–æ–¥ –æ—Ç–≤–µ—Ç.

–ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ —Å—Ç—Ä–æ—è—Ç –≥—Ä–∞—Ñ–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫ *–¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç–∏* (precision) –∏ *–ø–æ–ª–Ω–æ—Ç—ã* (recall). –¢–∞–∫–æ–π –≥—Ä–∞—Ñ–∏–∫ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è **PR-–∫—Ä–∏–≤–∞—è**.

![](./images/dst3-ml5-3_17.png)

–¢–∞–∫–∞—è –∫—Ä–∏–≤–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç:

- –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏ –ø–æ –ø–ª–æ—â–∞–¥–∏ (—á–µ–º –±–æ–ª—å—à–µ –ø–ª–æ—â–∞–¥—å, —Ç–µ–º –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–µ–µ –º–æ–¥–µ–ª—å)
- –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–æ–¥–µ–ª–µ–π –≤—ã–±—Ä–∞—Ç—å –ª—É—á—à—É—é (—Å –Ω–∞–∏–±–æ–ª—å—à–µ–π –ø–ª–æ—â–∞–¥—å—é)
- –≤—ã–±—Ä–∞—Ç—å –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ (—Å –±–æ–ª—å—à–µ–π –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω–æ—Å—Ç—å—é/–ø–æ–ª–Ω–æ—Ç–æ–π, –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∑–∞–¥–∞—á–∏)

–ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è PR-–∫—Ä–∏–≤–æ–π –º–æ–∂–Ω–æ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–π [cross_val_predict](https://scikit-learn.org/stable/modules/generated/sklearn.model_selection.cross_val_predict.html) –∏ [precision_recall_curve](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.precision_recall_curve.html). –ù–∞–π—Ç–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ –ø–ª–æ—â–∞–¥—å –∫—Ä–∏–≤–æ–π ‚Äî —Å –ø–æ–º–æ—â—å—é [argmax](https://numpy.org/doc/stable/reference/generated/numpy.argmax.html) –∏ [auc](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.auc.html) —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ.

### –°—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ

–∏–ª–∏ **oversampling** ‚Äî —ç—Ç–æ –º–µ—Ç–æ–¥ –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ —Å–æ–∑–¥–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –º–∏–Ω–æ—Ä–∏—Ç–∞—Ä–Ω–æ–≥–æ –∫–ª–∞—Å—Å–∞.

![](./images/dst3-ml5-3_24.png)

#### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
# !conda install -c conda-forge imbalanced-learn
from imblearn.over_sampling import SMOTE

sm = SMOTE(random_state=42)
X_train_s, y_train_s = sm.fit_resample(X_train, y_train)
```

### –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ù–µ—Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞ ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ —è–≤–ª–µ–Ω–∏–µ. –ù–æ –æ–Ω–∞ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –ø—Ä–∏—á–∏–Ω–æ–π –ø–ª–æ—Ö–∏—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π. –ù—É–∂–Ω–æ –ø–æ–º–Ω–∏—Ç—å –æ —Å–ø–æ—Å–æ–±–∞—Ö –±–æ—Ä—å–±—ã —Å —ç—Ç–∏–º–∏ –ø—Ä–æ–±–ª–µ–º–∞–º–∏:

- –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≥–æ—Ç–æ–≤–∏—Ç—å –≤—ã–±–æ—Ä–∫–∏ (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é)
- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—ç–º–ø–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
- –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–µ –º–æ–¥–µ–ª–∏ (–∞–Ω—Å–∞–º–±–ª–∏)
- –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–º–æ–≥–∞–µ—Ç, —Ç–æ –ø–æ–ª—É—á–∏—Ç—å –±–æ–ª—å—à–µ –¥–∞–Ω–Ω—ã—Ö

## –ù–µ–¥–æ–æ–±—É—á–µ–Ω–∏–µ –∏ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ; —É—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö

**–ù–µ–¥–æ–æ–±—É—á–µ–Ω–∏–µ** (underfitting) –∏ **–ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ** (overfitting) —ç—Ç–æ –¥–≤–µ –ø—Ä–æ–±–ª–µ–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –º–æ–¥–µ–ª–µ–π. –û–Ω–∏ –≤–∑–∞–∏–º–æ—Å–≤—è–∑–∞–Ω—ã, –∏ –±–æ—Ä—è—Å—å —Å –æ–¥–Ω–æ–π –∏–∑ –Ω–∏—Ö –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –¥—Ä—É–≥—É—é.

–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–æ–π –Ω–µ–¥–æ–æ–±—É—á–µ–Ω–∏—è —è–≤–ª—è–µ—Ç—Å—è **—Å–º–µ—â–µ–Ω–∏–µ** (bias). –≠—Ç–æ *–º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–∂–∏–¥–∞–Ω–∏–µ* –æ—à–∏–±–∫–∏.

–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–æ–π –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è —è–≤–ª—è–µ—Ç—Å—è **—Ä–∞–∑–±—Ä–æ—Å** (variance). –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ —ç—Ç–æ –¥–∏—Å–ø–µ—Ä—Å–∏—è.

### –í—ã—è–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è

–í—ã—è–≤–∏—Ç—å –Ω–µ–¥–æ–æ–±—É—á–µ–Ω–∏–µ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ: –µ—Å–ª–∏ –º–æ–¥–µ–ª—å –¥–µ–ª–∞–µ—Ç –ø–ª–æ—Ö–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –Ω–∞ –æ–±—É—á–∞—é—â–µ–π –≤—ã–±–æ—Ä–∫–µ, –∑–Ω–∞—á–∏—Ç –æ–Ω–∞ –Ω–µ–¥–æ–æ–±—É—á–µ–Ω–∞.

–° –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ–º —Å–ª–æ–∂–Ω–µ–µ. –ï—Å–ª–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–≤–∞, —Ç–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ –º–æ–∂–Ω–æ –≤—ã—è–≤–∏—Ç—å –≤–∏–∑—É–∞–ª—å–Ω–æ –Ω–∞ –¥–∏–∞–≥—Ä–∞–º–º–µ. –ù–æ –æ–±—ã—á–Ω–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –±–æ–ª—å—à–µ –¥–≤—É—Ö, –∏ –≤–∏–∑—É–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∏—Ö –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ. –ü–æ—ç—Ç–æ–º—É –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—é ‚Äî –º–æ–¥–µ–ª—å –ø—Ä–æ–≤–µ—Ä—è—é—Ç –Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–º –∏ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º –Ω–∞–±–æ—Ä–∞—Ö –¥–∞–Ω–Ω—ã—Ö –∏ —Å—Ä–∞–≤–Ω–∏–≤–∞—é—Ç –º–µ—Ç—Ä–∏–∫–∏. –ï—Å–ª–∏ –º–æ–¥–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ —Ö–æ—Ä–æ—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ –∏ —Å—Ç–∞–±–∏–ª—å–Ω–æ –ø–ª–æ—Ö–∏–µ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–º, –∑–Ω–∞—á–∏—Ç –æ–Ω–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∞.

### –ú–µ—Ç–æ–¥—ã –±–æ—Ä—å–±—ã —Å –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ–º

#### –ü–æ–Ω–∏–∂–µ–Ω–∏–µ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –º–æ–¥–µ–ª–∏

–î–ª—è –º–æ–¥–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ *–ª–∏–Ω–µ–π–Ω–æ–π (–∏–ª–∏ –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π) —Ä–µ–≥—Ä–µ—Å—Å–∏–∏* —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —É–º–µ–Ω—å—à–µ–Ω–∏–µ —Å—Ç–µ–ø–µ–Ω–∏ –ø–æ–ª–∏–Ω–æ–º–∞.

–î–ª—è –º–æ–¥–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ *–¥–µ—Ä–µ–≤–∞ —Ä–µ—à–µ–Ω–∏–π* —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —á—Ç–æ –Ω—É–∂–Ω–∞ **—Å—Ç—Ä–∏–∂–∫–∞ –¥–µ—Ä–µ–≤–∞** (prunning) ‚Äî¬†—É–º–µ–Ω—å—à–µ–Ω–∏–µ –≥–ª—É–±–∏–Ω—ã `max_depth` –∏/–∏–ª–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–≥–æ —á–∏—Å–ª–∞ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ª–∏—Å—Ç–∞ `min_samples_leaf`.

![](./images/dst3-ml5-4_8.png)

–°–≤–µ—Ä—Ö—É –º–æ–¥–µ–ª—å –¥–æ —Å—Ç—Ä–∏–∂–∫–∏, —Å–Ω–∏–∑—É ‚Äî¬†–ø–æ—Å–ª–µ. –ü–æ-—É–º–æ–ª—á–∞–Ω–∏—é –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≥–ª—É–±–∏–Ω–∞ –¥–µ—Ä–µ–≤–∞ –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞. –£–∑–Ω–∞—Ç—å –≥–ª—É–±–∏–Ω—É –≥–æ—Ç–æ–≤–æ–π –º–æ–¥–µ–ª–∏ –º–æ–∂–Ω–æ —Å –ø–æ–º–æ—â—å—é `.get_depth()`

![](./images/dst3-ml5-4_9.png)

–î–ª—è –º–æ–¥–µ–ª–µ–π –Ω–∞ –æ—Å–Ω–æ–≤–µ *—Å–ª—É—á–∞–π–Ω–æ–≥–æ –ª–µ—Å–∞* –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç—Ä–∏–∂–∫–∞ –¥–µ—Ä–µ–≤—å–µ–≤ (—Å–º. –≤—ã—à–µ), –∞ —Ç–∞–∫–∂–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ –∫–æ–ª-–≤–∞ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, –Ω–∞ –∫–æ—Ç–æ—Ä—ã—Ö –æ–±—É—á–∞–µ—Ç—Å—è –∫–∞–∂–¥–∞—è –º–æ–¥–µ–ª—å `max_features`.

#### –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è

–≠—Ç–æ –≤–≤–µ–¥–µ–Ω–∏–µ —à—Ç—Ä–∞—Ñ–∞ –∑–∞ –∏—Å–ø–æ–ª—å–∑–≤–∞–Ω–∏–µ –±–æ–ª—å—à–∏—Ö –∫–æ—ç—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤. –ó–∞ —Ä–∞–∑–º–µ—Ä —à—Ç—Ä–∞—Ñ–∞ –æ—Ç–≤–µ—á–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä `Œª`. –ï–≥–æ –Ω—É–∂–Ω–æ –ø–æ–¥–±–∏—Ä–∞—Ç—å –º–µ—Ç–æ–¥–æ–º –ø–µ—Ä–µ–±–æ—Ä–∞. –ï—Å–ª–∏ —Å–¥–µ–ª–∞—Ç—å –µ–≥–æ —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–Ω–∏–º, —Ç–æ –º–æ–¥–µ–ª—å –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω–æ–π, –∞ –µ—Å–ª–∏ —Å–ª—à–∏–∫–æ–º –±–æ–ª—å—à–∏–º ‚Äî —Ç–æ –º–æ–¥–µ–ª—å –∏–∑ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω–æ–π –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—Å—è –≤ –Ω–µ–¥–æ–æ–±—É—á–µ–Ω–Ω—É—é.

![](./images/dst3-ml5-4_10.png)

#### –ú–∞–Ω–∏–ø—É–ª—è—Ü–∏—è —Å –¥–∞–Ω–Ω—ã–º–∏

–ï—Å—Ç—å –¥–≤–∞ —Å–ø–æ—Å–æ–±–∞. –ü–µ—Ä–≤—ã–π ‚Äî –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç, –ø–æ–ø–æ–ª–Ω–∏–≤ –µ–≥–æ –Ω–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏. –í—Ç–æ—Ä–æ–π ‚Äî —É–¥–∞–ª–∏—Ç—å –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞ –≤—ã–±—Ä–æ—Å—ã –∏ –∞–Ω–æ–º–∞–ª–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —è–≤–ª—è—é—Ç—Å—è –æ—Ç—á–∞—Å—Ç–∏ –ø—Ä–∏—á–∏–Ω–æ–π –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è.

### –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö

**–£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö** (data leak) ‚Äî —ç—Ç–æ —Å–∏—Ç—É–∞—Ü–∏—è –∫–æ–≥–¥–∞ –æ–±—É—á–∞—é—â–∏–π –¥–∞—Ç–∞—Å–µ—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ –∫–æ—Å–≤–µ–Ω–Ω–æ –∏–ª–∏ –Ω–∞–ø—Ä—è–º—É—é —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å —Ü–µ–ª–µ–≤—ã–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º.

–≠—Ç–æ —è–≤–ª–µ–Ω–∏–µ –ø–æ—Ö–æ–∂–µ–µ –Ω–∞ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏–µ (—á–µ–º?), –Ω–æ –∏–º–µ–µ—Ç –¥—Ä—É–≥–æ–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä.

#### –û—á–µ–≤–∏–¥–Ω—ã–µ —Å–ª—É—á–∞–∏

–ú–æ–∂–µ—Ç –±—ã—Ç—å —Ç–∞–∫–∞—è —Å–∏—Ç—É–∞—Ü–∏—è, —á—Ç–æ –º–æ–¥–µ–ª—å –¥–∞–µ—Ç —Å–ª–∏—à–∫–æ–º —Ö–æ—Ä–æ—à–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã. –ö —ç—Ç–æ–º—É –Ω—É–∂–Ω–æ –æ—Ç–Ω–æ—Å–∏—Ç—å—Å—è —Å –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–µ–º. –í–æ–∑–º–æ–∂–Ω–æ —ç—Ç–æ –≤—ã–∑–≤–∞–Ω–æ –æ–¥–Ω–æ–π –∏–∑ –¥–≤—É—Ö –ø—Ä–∏—á–∏–Ω.

1. –ß–∞—Å—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ø–∞–ª–∞ –≤ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç.
2. –û–¥–∏–Ω –∏–∑ –æ–±—É—á–∞—é—â–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤ –∫–æ—Ä—Ä–µ–ª–∏—Ä—É–µ—Ç —Å —Ü–µ–ª–µ–≤—ã–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º.

–° —Ç–∞–∫–æ–π –ø—Ä–æ–±–ª–µ–º–æ–π —Å–ø—Ä–∞–≤–∏—Ç—å—Å—è –Ω–µ—Ç—Ä–µ–¥–Ω–æ, –Ω—É–∂–Ω–æ –ª–∏—à—å –±—ã—Ç—å –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã–º.

#### –°–∫—Ä—ã—Ç—ã–µ —Å–ª—É—á–∞–∏; giveaway-–ø—Ä–∏–∑–Ω–∞–∫–∏

–ë—ã–≤–∞—é—Ç —Å–∏—Ç—É–∞—Ü–∏–∏ —á—Ç–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –º–æ–¥–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–∞–∫–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø—Ä–∏ –≤–≤–µ–¥–µ–Ω–∏–∏ –º–æ–¥–µ–ª–∏ –≤ —ç–∫—Å–ø–ª—É–∞—Ç–∞—Ü–∏—é. –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è –±–æ–ª–µ–∑–Ω–∏ —Å–µ—Ä–¥—Ü–∞, –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ–ø–µ—Ä–∞—Ü–∏—è—Ö –Ω–∞ —Å–µ—Ä–¥—Ü–µ –±—É–¥–µ—Ç –±–µ–∑–æ—à–∏–±–æ—á–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç—å –ª—é–¥–µ–π —Å –±–æ–ª—å–Ω—ã–º —Å–µ—Ä–¥—Ü–µ–º, –Ω–æ –ø–æ–ª—É—á–µ–Ω–Ω–∞—è —Ç–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º –º–æ–¥–µ–ª—å –±—É–¥–µ—Ç –±–µ—Å–ø–æ–ª–µ–∑–Ω–∞, –ø–æ—Å–∫–æ–ª—å–∫—É –µ–µ –Ω–µ–ª—å–∑—è –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω–∏—Ç—å –∫ –ª—é–¥—è–º –±–µ–∑ –æ–ø–µ—Ä–∞—Ü–∏–π.

**Giveaway-–ø—Ä–∏–∑–Ω–∞–∫–∏** —Ä–∞–∫—Ä—ã–≤–∞—é—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –∏ –Ω–µ –±—É–¥—É—Ç –¥–æ—Å—Ç—É–ø–Ω—ã –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏. *–ò—Ö –Ω—É–∂–Ω–æ —É–¥–∞–ª—è—Ç—å –∏–∑ –¥–∞–Ω–Ω—ã—Ö!*

–ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å giveaway-–ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –Ω—É–∂–Ω–æ

- –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ —á–∏—Ç–∞—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
- –ø—Ä–æ–≤–µ—Ä—è—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—é —Ñ–∞–∫—Ç–æ—Ä–æ–≤ —Å —Ü–µ–ª–µ–≤—ã–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º
- –æ—Ç–Ω–æ—Å–∏—Ç—å—Å—è —Å–∫–µ–ø—Ç–∏—á–µ—Å–∫–∏ –∫ —Å–ª–∏—à–∫–æ–º —Ö–æ—Ä–æ—à–∏–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º

### –ö—Ä–∏–≤–∞—è –æ–±—É—á–µ–Ω–∏—è

‚Äî –∏–ª–∏ *learning curve* ‚Äî —ç—Ç–æ –≥—Ä–∞—Ñ–∏–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–µ—Ç—Ä–∫–∏ –æ—Ç –∫–æ–ª-–≤–∞ –¥–∞–Ω–Ω—ã—Ö, –≤–∑—è—Ç—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏. –û–±—ã—á–Ω–æ –≤—ã–±–∏—Ä–∞—é—Ç –∫–∞–∫—É—é-—Ç–æ –º–µ—Ç—Ä–∏–∫—É –∏ —Å—Ç—Ä–æ—è—Ç –¥–≤–µ –∫—Ä–∏–≤—ã—Ö –Ω–∞ –æ–¥–Ω–æ–º –≥—Ä–∞—Ñ–∏–∫–µ: –æ–¥–Ω–∞ –∫—Ä–∏–≤–∞—è —Å—Ç—Ä–æ–∏—Ç—Å—è –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏, –¥—Ä—É–≥–∞—è –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π. –ü—Ä–∏ —ç—Ç–æ–º –º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏ —Å—á–∏—Ç–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —É—á–∞—Å—Ç–≤–æ–≤–∞–≤—à–∏—Ö –≤ –æ–±—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö, –∞ –º–µ—Ç—Ä–∏–∫–∞ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏ —Å—á–∏—Ç–∞–µ—Ç—Å—è –¥–ª—è –≤—Å–µ–π –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–∏ (–ø–æ—ç—Ç–æ–º—É –ø–µ—Ä–≤–∞—è –º–µ—Ç—Ä–∏–∫–∞ —É—Ö—É–¥—à–∞–µ—Ç—Å—è –ø—Ä–∏ –≤–æ–∑—Ä–∞—Å—Ç–∞–Ω–∏–∏ –∫–æ–ª-–≤–∞ –ø—Ä–∏–º–µ—Ä–æ–≤, –∞ –≤—Ç–æ—Ä–∞—è –Ω–∞–æ–±–æ—Ä–æ—Ç —É–ª—É—á—à–∞–µ—Ç—Å—è).

–ù–∞ —Ç–∞–∫–æ–º –≥—Ä–∞—Ñ–∏–∫–µ –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –≤—ã—è–≤–∏—Ç—å:

- –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å (–∫—Ä–∏–≤—ã–µ –Ω–µ –ø–æ–¥—Ö–æ–¥—è—Ç –±–ª–∏–∑–∫–æ –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É)
- –Ω–µ–¥–æ–æ–±—É—á–µ–Ω–Ω—É—é –º–æ–¥–µ–ª—å (–∫—Ä–∏–≤—ã–µ —Å—Ö–æ–¥—è—Ç—Å—è –Ω–∏–∂–µ –∂–µ–ª–∞–µ–º–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è –º–µ—Ç—Ä–∏–∫–∏)
- –º–æ–¥–µ–ª—å —Ç–æ-—á—Ç–æ-–Ω—É–∂–Ω–æ (–∫—Ä–∏–≤—ã–µ —Å—Ö–æ–¥—è—Ç—Å—è –Ω–∞ –∂–µ–ª–∞–µ–º–æ–º –∑–Ω–∞—á–µ–Ω–∏–∏ –º–µ—Ç—Ä–∏–∫–∏)

![](./images/dst3-ml5-5_7.png)

–°–æ–ø–æ—Å—Ç–∞–≤–∏–≤ –≥—Ä–∞—Ñ–∏–∫–∏ —Ä–∞–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π, –ø–æ—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –Ω–∞ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö, –º–æ–∂–Ω–æ —Å—Ä–∞–≤–Ω–∏—Ç—å –∏—Ö –ø–æ –∫–∞—á–µ—Å—Ç–≤—É.

## –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥

–≠—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∫ –æ–±—É—á–µ–Ω–∏—é. –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å
- –Ω–µ –ø–æ–ª–Ω—ã
- –Ω–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã
- –Ω–µ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω—ã
- –Ω–µ —Ç–æ—á–Ω—ã (—Å–æ–¥–µ—Ä–∂–∞—Ç—å –∞–Ω–æ–º–∞–ª–∏–∏ –∏ –≤—ã–±—Ä–æ—Å—ã)

### –ö–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–í Pandas –µ—Å—Ç—å –º–µ—Ç–æ–¥ [get_dummies](https://pandas.pydata.org/docs/reference/api/pandas.get_dummies.html) —Å –ø—Ä–æ—Å—Ç—ã–º API, –∏ —Ö–æ—Ä–æ—à–æ –ø–æ–¥—Ö–æ–¥—è—â–∏–π –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –ø—Ä–æ—Å—Ç—ã—Ö –∑–∞–¥–∞—á. –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é –æ–Ω –Ω–µ –ø—Ä–∏–≥–æ–¥–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ –ø—Ä–æ–¥–∞–∫—à–Ω.

–î–ª—è —Å–µ—Ä—å–µ–∑–Ω—ã—Ö –∑–∞–¥–∞—á –ø—Ä–∏–º–µ–Ω—è—é—Ç –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫–∏ –∏–∑ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ [sklearn.processing](https://scikit-learn.org/stable/modules/classes.html#module-sklearn.preprocessing):

- `LabelEncoder` –¥–ª—è –ø–æ—Ä—è–¥–∫–æ–≤–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
- `LabelBinarizer` –¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è
- `OneHotEncoder` –¥–ª—è –æ–¥–Ω–æ–∫—Ä–∞—Ç–Ω–æ–≥–æ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è

–£ –Ω–∏—Ö –≤—Å–µ—Ö –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π API, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏–º–µ—Ä –Ω–∏–∂–µ –º–æ–∂–Ω–æ –ª–µ–≥–∫–æ –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å –ø–æ–¥ –Ω—É–∂–Ω—ã–π –∫–æ–¥–∏—Ä–æ–≤—â–∏–∫.

#### –†–µ–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
# import pandas as pd
# from sklearn import preprocessing as ce

def apply_onehot(data, columns, encoder=None):
    if encoder is None:
        encoder = ce.OneHotEncoder()

    encoder.fit(data[columns])

    tranformed_arr = encoder.transform(data[columns]).toarray()

    tranformed_df = pd.DataFrame(
        data=tranformed_arr,
        columns=encoder.get_feature_names_out(columns),
        index=data.index,
    )

    data.drop(columns=columns, inplace=True)

    for column in tranformed_df.columns.values:
        data[column] = tranformed_df[column]

    return encoder
```

### –†–∞–±–æ—Ç–∞ —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–æ–ø—É—Å–∫–∞–º–∏ –ø–æ–º–æ–≥—É—Ç —Ç—Ä–∏ –º–µ—Ç–æ–¥–∞ Pandas:

- `isna`
- `dropna`
- `fillna`

#### –ü—Ä–∏–º–µ—Ä –Ω–∞ python

```python
# get mask for all missing values in column
m = df['my_column'].isna()

# removes rows where less than 10 non-NA values
df.dropna(thresh=10, inplace=True)

# removes all the rows with NA
df.dropna(inplace=True)

# fills NA with mode/median/mean
df.fillna({
    'column A': df['column A'].mode()[0],
    'column B': df['column B'].median(),
    'column C': df['column C'].mean(),
})
```

–¢–∞–∫–∂–µ –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç—É—é –º–æ–¥–µ–ª—å, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–ø–æ–ª–Ω–∏—Ç –ø—Ä–æ–ø—É—Å–∫–∏.

### –†–∞–±–æ—Ç–∞ —Å –≤—ã–±—Ä–æ—Å–∞–º–∏

–í –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞—è—Ö –º–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤—ã–±—Ä–æ—Å—ã —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ, –ø–æ—Å—Ç—Ä–æ–∏–≤ –∫–æ—Ä–æ–±—á–∞—Ç—É—é –¥–∏–∞–≥—Ä–∞–º—É. –ù–æ –¥–ª—è –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–∞ —Ç–∞–∫–∂–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏) –º–æ–∂–Ω–æ –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≥–æ—Ç–æ–≤—ã–º–∏ –∞–ª–≥–æ—Ä–∏—Ç–∞–º–∞–º–∏. –í sklearn –∏—Ö —Ç—Ä–∏:

- Isolation Forest
- Local Outlier Factor, LOF
- Minimum Covariance Determinant, MCD

#### Isolation Forest

–ê–ª–≥–æ—Ä–∏—Ç–º –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–µ—Ä–µ–≤–∞. –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –Ω–∞—Ö–æ–¥–∏—Ç –∞–Ω–æ–º–∞–ª–∏–∏ –≤ –º–Ω–æ–≥–æ–º–µ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö. –ï–≥–æ –æ—Å–Ω–æ–≤–Ω–æ–π –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä ‚Äî `contamination` (–∑–∞–≥—Ä—è–∑–Ω–µ–Ω–∏–µ). –û–Ω –º–µ–Ω—è–µ—Ç—Å—è –æ—Ç `0.0` –¥–æ `0.5`, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `0.1`. –ï—Å—Ç—å –∏ –¥—Ä—É–≥–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –æ –Ω–∏—Ö –º–æ–∂–Ω–æ —É–∑–Ω–∞—Ç—å [–Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞](https://scikit-learn.org/stable/modules/generated/sklearn.ensemble.IsolationForest.html).

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Python

```python
from  sklearn.ensemble import IsolationForest
 
iso = IsolationForest(contamination=0.1)
y_predicted = iso.fit_predict(X_train)

m = y_predicted == -1
X_train, y_train = X_train[~m], y_train[~m]
```

#### Local Outlier Factor (LOF)

–ò—â–µ—Ç –≤—ã–±—Ä–æ—Å—ã –æ—Ü–µ–Ω–∏–≤–∞—è —É–¥–∞–ª–µ–Ω–Ω–æ—Å—Ç—å —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –æ—Ç –±–ª–∏–∂–∞–π—à–∏—Ö —Å–æ—Å–µ–¥–µ–π. –°–∞–º—ã–µ —É–¥–∞–ª–µ–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –±—É–¥—É—Ç —Å—á–∏–∞—Ç—å—Å—è –∞–Ω–æ–º–∞–ª–∏—è–º–∏. –û –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –∫–ª–∞—Å—Å–∞ –º–æ–∂–Ω–æ —É–∑–Ω–∞—Ç—å [–Ω–∞ –µ–≥–æ —Å—Ç—Ä–∞–Ω–∏—Ü–µ](https://scikit-learn.org/stable/modules/generated/sklearn.neighbors.LocalOutlierFactor.html).

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Python

```python
from sklearn.neighbors import LocalOutlierFactor
 
lof = LocalOutlierFactor()
y_predicted = lof.fit_predict(X_train)

m = y_predicted == -1
X_train, y_train = X_train[~m], y_train[~m]
```

#### Minimum Covariance Determinant (MCD)

–≠—Ç–æ—Ç –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥—Ö–æ–¥–∏—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è –¥–∞–Ω–Ω—ã—Ö —Å –≥–∞—É—Å–æ–≤—Å–∫–∏–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã –æ—Ü–µ–Ω–∫–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è. (–û–Ω —Å—Ç—Ä–æ–∏—Ç –≥–∏–ø–µ—Ä—Å—Ñ–µ—Ä—É, –ø–æ–∫—Ä—ã–≤–∞—é—â—É—é –Ω–æ—Ä–º–∞–ª—å–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ, –∏ —Å—á–∏—Ç–∞–µ—Ç –≤—ã–±—Ä–æ—Å–∞–º–∏ –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –∑–∞ –µ–µ –ø—Ä–µ–¥–µ–ª–∞–º–∏.)

–í sklearn –¥–∞–Ω–Ω—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω –∫–ª–∞—Å—Å–æ–º [EllipticEnvelope](https://scikit-learn.org/stable/modules/generated/sklearn.covariance.EllipticEnvelope.html)

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Python

```python
from sklearn.covariance import EllipticEnvelope
 
ee = EllipticEnvelope(contamination=0.01)
y_predicted = ee.fit_predict(X_train)

m = y_predicted == -1
X_train, y_train = X_train[~m], y_train[~m]
```
### –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

#### –ö–≤–∞–Ω—Ç–∏–ª—å–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ

–ö–ª–∞—Å—Å [QuantaileTransformer](https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.QuantileTransformer.html) –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å –Ω–æ—Ä–º–∞–ª—å–Ω–æ–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ–º–µ—Ä–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ. –ö–∞–∫ –æ–Ω —ç—Ç–æ –¥–µ–ª–∞–µ—Ç –º–Ω–µ –Ω–µ —Å–æ–≤—Å–µ–º –ø–æ–Ω—è—Ç–Ω–æ. –ò–∑–≤–µ—Å—Ç–Ω–æ, —á—Ç–æ –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ `PDF`, `CDF` –∏ `PPF`.

![](./images/dst3-ml6-6_1.png)

‚ùóÔ∏è –ú–∏–Ω—É—Å –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω–æ –º–æ–∂–µ—Ç —Ä–∞–∑—Ä—É—à–∏—Ç—å –ª–∏–Ω–µ–π–Ω—ã–µ —Å–≤—è–∑–∏ –º–µ–∂–¥—É –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ–º—ã–º –ø—Ä–∏–∑–Ω–∞–∫–æ–º –∏ –¥—Ä—É–≥–∏–º–∏.

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Python

```python
from sklearn.preprocessing import QuantileTransformer

# output_distribution can be "normal" or "uniform"
qtr = QuantileTransformer(output_distribution='normal')
columns = ['year', 'condition']
data[columns] = qtr.fit_transform(data[columns].values)

# data[columns].hist();
```

#### –õ–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ

–û—á–µ–Ω—å –ø–æ–ø—É–ª—è—Ä–Ω–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ. –ï–≥–æ –æ—á–µ–Ω—å –ø—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å. –í –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∫–≤–∞–Ω—Ç–∏–ª—å–Ω–æ–≥–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è, –ª–∏–Ω–µ–π–Ω—ã–µ —Å–≤—è–∑–∏ –±—É–¥—É—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã.

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Python

```python
import numpy as np

columns = ['price']
data[columns] = np.log(data[columns].values)

# data[columns].hist();
```

#### –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ –ë–æ–∫—Å–∞-–ö–æ–∫—Å–∞ –∏ –ô–µ–æ-–î–∂–æ–Ω—Å–æ–Ω–∞

–ö–ª–∞—Å—Å [PowerTransformer](https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.PowerTransformer.html) –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω –∏–∑ –¥–≤—É—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤:

- –º–µ—Ç–æ–¥ –ë–æ–∫—Å–∞-–ö–æ–∫—Å–∞ (–ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å–æ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ `> 0`)
- –º–µ—Ç–æ–¥ –ô–µ–æ-–î–∂–æ–Ω—Å–æ–Ω–∞ (–ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –ª—é–±—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π)

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Python

```python
from sklearn.preprocessing import PowerTransformer

#  methods: 'box-cox' or 'yeo-johnson'
ptr = PowerTransformer(method='box-cox')
columns = ['year', 'price']
data[columns] = ptr.fit_transform(data[columns].values)

# data[columns].hist();
```

#### –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —à–∏—Ä–æ—Ç—ã –∏ –¥–æ–ª–≥–æ—Ç—ã

–° –ø–æ–º–æ—â—å—é –∫–ª–∞—Å—Å–∞ [geopy](https://pypi.org/project/geopy/) –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å –ø–æ—á—Ç–æ–≤—ã–π –∞–¥—Ä–µ—Å –ø–æ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º.

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Python

```python
from geopy.geocoders import Nominatim

geolocator = Nominatim(user_agent="geoapiExercises")
lat = 45.518031
lng = -122.578752
location = geolocator.reverse(f'{lat}, {lng}')

# print(location)
# location.raw
# location.raw['address']
```

### –û—Ç–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

#### RFE

–î–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–∏ –º—ã –º–æ–∂–µ–º –≤–∑—è—Ç—å –Ω–µ –≤—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏. –í –ø–µ—Ä–≤—É—é –æ—á–µ—Ä–µ–¥—å —Å–ª–µ–¥—É–µ—Ç –∏—Å–∫–ª—é—á–∏—Ç—å –º—É–ª—å—Ç–∏–∫–æ–ª–ª–∏–Ω–µ–∞—Ä–Ω—ã–µ —Ä–ø—Ä–∏–∑–Ω–∞–∫–∏. –ò–∑ –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è –Ω—É–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Å–∞–º—ã–µ –≤–∞–∂–Ω—ã–µ. –î–ª—è —ç—Ç–æ–≥–æ –≤ sklearn –µ—Å—Ç—å *–º–µ—Ç–æ–¥ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ–≥–æ –∏—Å–∫–ª—é—á–µ–Ω–∏—è* (RFE). –û–Ω –æ–±—É—á–∞–µ—Ç –º–æ–¥–µ–ª—å –Ω–∞ –≤—Å–µ—Ö –ø—Ä–∏–∑–Ω–∞–∫–∞—Ö, –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç –≤–∫–ª–∞–¥ –∫–∞–∂–¥–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞, —É–±–∏—Ä–∞–µ—Ç –Ω–∞–∏–º–µ–Ω–µ–µ –≤–∞–∂–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏ —Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å, –ø–æ–¥–±–∏—Ä–∞—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ python

```python
from sklearn.feature_selection import RFE

estimator = linear_model.LinearRegression()

# n_features_to_select - —Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –æ—Å—Ç–∞–≤–∏—Ç—å
# step - —Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —É–±–∏—Ä–∞—Ç—å –∑–∞ –æ–¥–Ω—É –∏—Ç–µ—Ä–∞—Ü–∏—é
# –æ–±–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –º–æ–≥—É—Ç –±—ã—Ç—å —Ç–∏–ø–∞ int –∏–ª–∏ float (–æ—Ç 0 –¥–æ 1)
# int –¥–ª—è –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –∫–æ–ª-–≤–∞, float ‚Äî –¥–ª—è –¥–æ–ª–∏ –æ—Ç —Ü–µ–ª–æ–≥–æ
selector = RFE(estimator, step=1)
selector = selector.fit(X_train, y_train)
selector.get_feature_names_out()

# pd.DataFrame({
#     "columns": X_train.columns.values,
#     "rank": selector.ranking_,
# }).sort_values(by=['rank'])

```

#### –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ –º–µ—Ç–æ–¥—ã

–ú–æ–∂–Ω–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –æ—Ü–µ–Ω–∫—É –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ —Å –ø–æ–º–æ—â—å—é —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏—Ö –º–µ—Ç–æ–¥–æ–≤.

![](./images/dst3-ml6-9_3.png)

–≠—Ç–∏ –º–µ—Ç–æ–¥—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞—Ö sklearn –∏ SciPy:

- –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –ü–∏—Ä—Å–æ–Ω–∞ [f_regression()](https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.f_regression.html)
- —Ä–∞–Ω–≥–æ–≤–∞—è –∫–æ—Ä—Ä–µ–ª—è—Ü–∏—è –°–ø–∏—Ä–º–∞–Ω–∞ [spearmanr](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.spearmanr.html)
- –¥–∏—Å–ø–µ—Ä—Å–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑–∞ ANOVA [f_classif()](https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.f_classif.html)
- –ö–µ–Ω–¥–∞–ª–ª [kendalltau](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.kendalltau.html)
- —Ö–∏-–∫–≤–∞–¥—Ä–∞—Ç [chi2()](https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.chi2.html)
- Mutual Information [mutual_info_classif()](https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.mutual_info_classif.html) –∏ [mutual_info_regression()](https://scikit-learn.org/stable/modules/generated/sklearn.feature_selection.mutual_info_regression.html)

#### –û—Ç–±–æ—Ä –Ω–∞–∏–±–æ–ª–µ–µ –≤–∞–∂–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

–ï—Å—Ç—å —É–¥–æ–±–Ω—ã–π –∫–ª–∞—Å—Å `SelectKBest`, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –≤—ã–±—Ä–∞—Ç—å `K` —Å–∞–º—ã—Ö –≤–∞–∂–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

##### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞ Python

```python
from sklearn.feature_selection import SelectKBest, f_regression

selector = SelectKBest(f_regression, k=3)
selector.fit(X_train, y_train)
 
selector.get_feature_names_out()
```